<!doctype html><html class="no-js" lang="en"><head><meta charset="utf-8"><meta name="author" content="Geshan Manandhar"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="In this tutorial, learn how to use Next.js with docker with a step-by-step example."><meta name="keywords" content="nextjs docker, docker nextjs, next.js docker, docker next.js"><meta name="p:domain_verify" content="e654c68562abebfa25c291f59d7d00e8"><meta property="og:type" content="website"><meta property="og:url" content="https://geshan.com.np/blog/2023/01/nextjs-docker/"><meta property="og:title" content="How to use Next.js with Docker and Docker compose a beginner&#39;s guide"><meta property="og:description" content="In this tutorial, learn how to use Next.js with docker with a step-by-step example."><meta property="og:site_name" content="Geshan&#39;s Blog"><meta property="og:image" content="https://geshan.com.np/images/nextjs-docker/01nextjs-docker.jpg"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:widgets:new-embed-design" content="on"><meta name="twitter:site" content="@geshan"><meta name="twitter:creator" content="@geshan"><meta name="twitter:title" content="How to use Next.js with Docker and Docker compose a beginner&#39;s guide"><meta name="twitter:description" content="In this tutorial, learn how to use Next.js with docker with a step-by-step example."><meta name="twitter:image:src" content="https://geshan.com.np/images/nextjs-docker/01nextjs-docker.jpg"><link rel="canonical" href="https://geshan.com.np/blog/2023/01/nextjs-docker/"><meta property="fb:pages" content="30717799226"><meta property="fb:app_id" content="106030259434380"><meta name="monetization" content="$ilp.uphold.com/aKHWpqhphm9f"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png"><link href="/atom.xml" rel="alternate" title="Geshan&#39;s Blog" type="application/atom+xml"><title>How to use Next.js with Docker and Docker compose a beginner&#39;s guide</title><link rel="preconnect" href="/" crossorigin><link rel="preload" href="/css/fonts.css" as="style"><link rel="preload" href="/fonts/source-sans-4/source-serif-4-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/fonts/source-sans-4/source-serif-4-latin-500-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/fonts/source-sans-pro/source-sans-pro-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="/css/fonts.css"><link rel="stylesheet" href="/css/tw-006.css"><link rel="alternate" href="/atom.xml" type="application/atom+xml" title="Geshan&#39;s Blog"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-P3NXCVQEPE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-P3NXCVQEPE');</script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWT2D9T');</script><script src="https://cdn.jsdelivr.net/npm/@statsig/js-client@3/build/statsig-js-client+session-replay+web-analytics.min.js?apikey=client-rYO7rX8WSUyyLg9pKJwymLxM71tCE0CKgxgtUj4akzK"></script><link rel="manifest" href="/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="application-name" content="Geshan.com.np"><meta name="apple-mobile-web-app-title" content="Geshan.com.np"><meta name="msapplication-starturl" content="/index.html"><meta name="theme-color" content="#6947E7"><script>if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/sw.js").then(function(registration) {
        console.log('ServiceWorker registration successful with scope: ', registration.scope);
    }, function(err) {
        console.log('ServiceWorker registration failed: ', err);
    });
  }</script></head><body class="overflow-x-hidden font-ui flex flex-col min-h-screen"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWT2D9T" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><header role="banner"><div><nav class="bg-white" role="navigation"><div class="w-full md:max-w-6xl mx-auto py-4 px-4"><div class="flex items-center justify-between h-16"><div class="flex-shrink-0"><a href="/" class="flex items-center"><img class="h-12 w-12" src="/images/theme/new_logo.svg" alt="Geshan G"></a></div><div class="flex items-center gap-12"><div class="hidden sm:flex items-center gap-12"><a href="/posts/1/" class="uppercase text-base font-ui font-medium text-gray hover:text-midgrey transition-colors" aria-current="page">Posts </a><a href="/about/" class="uppercase text-base font-ui font-medium text-gray hover:text-midgrey transition-colors" aria-current="page">About Me </a><a href="https://newsletter.geshan.com.np/" class="uppercase text-base font-ui font-medium text-gray hover:text-midgrey transition-colors" aria-current="page">Newsletter</a></div><form class="search flex items-center" action="https://www.google.com/search" method="GET"><input type="hidden" name="sitesearch" value="geshan.com.np"><div class="relative"><input class="bg-gray-100 border border-neutralGray rounded-lg py-2 pl-10 pr-4 font-body text-sm focus:outline-none focus:ring-2 focus:ring-avocado focus:border-transparent w-40" type="text" name="q" placeholder="Search" label="search"> <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-neutralGray" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg></div></form><button type="button" class="sm:hidden inline-flex items-center justify-center p-2 rounded-md text-black focus:outline-none focus:ring-2 focus:ring-inset focus:ring-avocado" onclick="mobileView()" aria-controls="mobile-menu" aria-expanded="false"><span class="sr-only">Open main menu</span> <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button></div></div></div><div class="mobile-menu fixed inset-0 z-40 hidden sm:hidden bg-black bg-opacity-40" role="dialog" aria-modal="true"><div class="absolute inset-0" onclick="mobileView()" aria-hidden="true"></div><div class="mobile-menu-panel relative ml-auto flex h-full w-10/12 max-w-sm flex-col justify-start bg-white shadow-xl"><div class="flex items-center justify-between px-4 py-4 border-b border-gray-200"><div class="flex items-center gap-3"><img class="h-8 w-8" src="/images/theme/new_logo.svg" alt="Geshan G"> <span class="text-lg font-semibold text-textColor font-body">Geshan's Blog</span></div><button type="button" class="inline-flex items-center justify-center rounded-full p-2 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-avocado" onclick="mobileView()" aria-label="Close main menu"><svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button></div><nav class="overflow-y-auto px-4 py-6 space-y-2"><a href="/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">Home </a><a href="/posts/1/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">Posts </a><a href="/about/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">About Me </a><a href="https://newsletter.geshan.com.np/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">Newsletter</a></nav><div class="px 4 py-4 border-t border-gray-200"><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="rounded-lg bg-darkAvocado px-4 py-2 text-base font-regular font-body text-white hover:bg-avocado hover:text-black transition-colors w-2/3 mx-auto ml-4">Connect on LinkedIn</a></div></div></div></nav></div></header><main id="wrap" role="main" class="flex-grow md:px-0"><div id="content"><div class="row"><div><script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Geshan&#39;s Blog",
    "alternativeHeadline": "How to use Next.js with Docker and Docker compose a beginner&#39;s guide",
    "image": "https://geshan.com.np/images/nextjs-docker/01nextjs-docker.jpg",
    "editor": "Geshan Manandhar",
    "genre": "Node.js",
    "keywords": "nextjs docker, docker nextjs, next.js docker, docker next.js",
    "url": "https://geshan.com.np/blog/2023/01/nextjs-docker/",
    "datePublished": "2023-01-08",
    "dateCreated": "2023-01-08",
    "dateModified": "2023-01-08",
    "description": "In this tutorial, learn how to use Next.js with docker with a step-by-step example.",
    "articleBody": "Next.js is a popular and opinionated React based meta-framework with a tagline of “Production grade React applications that scale”. Using Next.js with Docker has multiple advantages. This tutorial will walk you through setting up and running a Next.js project with Docker and Docker Compose, let&#39;s get started!Table of contents #What is Next.jsNext.js popularityWhy use next.js with DockerPrerequisitesInstall Next.js without DockerDocker image for Next.jsAdding Docker compose for Next.jsRun Next.js with docker composeConclusionWhat is Next.js #Before going further. let’s analyze why you need Next.js as a meta-framework on top of React. The debate is that React is just a library for building UI and not a framework. There are multiple ways and other libraries to do things in React (same as JavaScript). For instance, there are at least 6 libraries to do state management in React.This is where Next.js and its opinionated decisions shine. Next.js brands itself as “The React Framework for Production” and it is open source, of course. Created by Vercel, Next.js is reportedly used by Nike, Realtor, Door Dash, and TypeForm to name some. Some features of Next.js include hybrid static and server rendering, TypeScript support, and smart bundling.The main feature and reason for Next.js I believe is that it is React++. By that I mean,Next.js helps you get over the decision fatigue that comes with React (and JavaScript in general) as it makes those decisions for you to a great extent following the “best practices”.Don’t forget though, Next.js is a layer on top of React.js. It is the “framework” layer.  For one project we worked with in 2020, the need was to do Server side rendering, and React did not do it out of the box. This is a use case to use Next.js. Unfortunately, we went with another solution but looking at hindsight Next.js would have been the best option then.Next.js popularity #Next.js is the most popular React meta-framework out there. As per NPM trends, it was downloaded 4.23 million times toward the end of Oct-2022. React is downloaded a lot more than Gatsby, Nuxt, Razzle, and Remix combined which are some of its competitors. As the picture speaks:If it was a popularity contest, Next.js blows the other competitor out of the water. Being backed by Vercel it is also easy to host a Next.js application on Vercel. In the next section, you will learn why to use Next.js with Docker.Why use next.js with Docker #Similar to Dockerizing other applications, when you put the Next.js application on a docker container it has some advantages. There first one is that you ship the whole stack not only your code, the stack includes the OS, any other language/executables in specific versions and your code. This means you get over works on my machine syndrome.In addition to making it portable, Docker also helps to run multiple copies of your application that can be scaled horizontally. As spinning up a docker container is relatively easy and cheap this helps with scaling your applications much easier with a container orchestrator like Kubernetes. All of these benefits surely apply to your Next.js app.As Next.js also supports on server side rendering and API routes, the applications using these features cannot be cached on the CDN. This is where if the Next.js app is Dockerized it can be easily deployed into a Kubernetes cluster or even on serverless containers.Prerequisites #Before you jump into the code, below are some requisites:You should have Node.js installed on your system preferably the latest LTS which is Node.js v 18 at the time of writing. Similarly, some knowledge of npm and npx will also be needed.Have Docker installed and  docker-compose installed on your machineAny prior experience with Next.js is beneficial but not necessary.In the next section, you will install Next.js without Docker and then Dockerize it.Install Next.js without Docker #For this tutorial, you will use the API Routes example from the official Next.js examples. You can install this example by running:npx create-next-app --example api-routes api-routes-appIt will show an output like the one below:To test out if the example is working properly you can execute:cd api-routes-appnpm run devIt will run the server and now you can access the app at  some code .I hope you have learned how to dockerize any Next.js app. Keep learning!",
    "author": { "@type": "Person", "name": "Geshan Manandhar" },
    "publisher": {
      "@type": "Organization",
      "name": "Geshan Manandhar",
      "logo": { "@type": "ImageObject", "url": "https://geshan.com.np/images/favicons/favicon-32x32.png" }
    },
    "mainEntityOfPage": { "@type": "WebPage", "@id": "https://geshan.com.np/blog/2023/01/nextjs-docker/" }
  }</script><div class="progress-bar"></div><div class="max-w-6xl py-3 mx-auto grid-cols-12 grid gap-15 px-4 md:px-0 mb-20"><div class="col-span-12"><article class="md:w-full mx-auto"><header class="page-header text-center"><h1 class="font-semibold font-heading text-gray text-center mb-6 tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to use Next.js with Docker and Docker compose a beginner&#39;s guide</h1><div class="flex items-center justify-between gap-3 md:gap-4 flex-wrap md:flex-nowrap py-2 border-y border-lightbg mt-4"><div class="flex items-center justify-start md:gap-4 gap-2 flex-wrap w-2/3"><div class="flex justify-start items-center gap-3 md:gap-4"><img src="/images/favicons/favicon-32x32-pp.png" alt="Geshan Manandhar" class="w-10 h-10 rounded-full object-cover flex-shrink-0"> <span class="text-gray font-medium font-ui text-md md:text-xl uppercase tracking-wide text-start">Geshan Manandhar</span></div><time datetime="2023-01-08" data-updated="true"><time class="entry-date" datetime="2023-01-08"><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">08-Jan-2023 </span></time></time><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">8 MIN READ</span></div><button type="button" id="share-button" class="flex items-center justify-center w-8 h-8 md:w-9 md:h-9 rounded text-lightGray hover:border-gray-400 hover:bg-gray-50 transition-colors flex-shrink-0" aria-label="Share this post" onclick="toggleShareIcons(); ga('send', 'event', 'share', 'clickShareOnPost');"><img src="/images/shareIcon.svg" alt="Share this post" class="w-6 h-6"></button></div><div id="share-icons-container" class="share-icons print:hidden hidden" aria-label="Share this post"><div class="flex items-center justify-center gap-3"><span class="share-icons"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://geshan.com.np/blog/2023/01/nextjs-docker/" target="_blank" title="Share 'How to use Next.js with Docker and Docker compose a beginner&#39;s guide' on LinkedIn" onclick="ga('send', 'event', 'share', 'clickShareOnLinkedIn');"><span id="linkedin-share" class="text-[#0077B5]"><img src="/images/social-icons/linkedin.svg" alt="LinkedIn" class="sharing-common"> </span></a><a href="http://twitter.com/share?text=How to use Next.js with Docker and Docker compose a beginner&#39;s guide - &url=https://geshan.com.np/blog/2023/01/nextjs-docker/" target="_blank" title="Share 'How to use Next.js with Docker and Docker compose a beginner&#39;s guide' on Twitter" onclick="ga('send', 'event', 'share', 'clickShareOnTwitter');"><span id="twitter-share" class="text-[#1DA1F2]"><img src="/images/social-icons/twitter.svg" alt="Twitter" class="sharing-common"> </span></a><a href="http://www.facebook.com/sharer.php?u=https://geshan.com.np/blog/2023/01/nextjs-docker/" target="_blank" title="Share 'How to use Next.js with Docker and Docker compose a beginner&#39;s guide' on Facebook" onclick="ga('send', 'event', 'share', 'clickShareOnFacebook');"><span id="facebook-share" class="text-[#1877F2]"><img src="/images/social-icons/facebook.svg" alt="Facebook" class="sharing-common"> </span></a><a href="https://t.me/share/url?url=https://geshan.com.np/blog/2023/01/nextjs-docker/" target="_blank" title="Share 'How to use Next.js with Docker and Docker compose a beginner&#39;s guide' on Telegram" onclick="ga('send', 'event', 'share', 'clickShareOnTelegram');"><span id="telegram-share" class="text-[#0088cc]"><img src="/images/social-icons/telegram.svg" alt="Telegram" class="sharing-common"> </span></a><a href="https://api.whatsapp.com/send?text=https://geshan.com.np/blog/2023/01/nextjs-docker/" target="_blank" title="Share 'How to use Next.js with Docker and Docker compose a beginner&#39;s guide' on Whatsapp" onclick="ga('send', 'event', 'share', 'clickShareOnWhatsapp');"><span id="whatsapp-share" class="text-[#25d366]"><img src="/images/social-icons/whatsapp.svg" alt="WhatsApp" class="sharing-common"></span></a></span></div></div></header><div class="entry-content clearfix font-body text-xl text-gray"><p>Next.js is a popular and opinionated React based meta-framework with a tagline of “Production grade React applications that scale”. Using Next.js with Docker has multiple advantages. This tutorial will walk you through setting up and running a Next.js project with Docker and Docker Compose, let's get started!</p><img class="center" loading="lazy" src="/images/nextjs-docker/01nextjs-docker.jpg" title="Next.js with Docker and docker compose illustrated with logos" alt="Next.js with Docker and docker compose illustrated with logos"><h2 id="table-of-contents" tabindex="-1">Table of contents <a class="direct-link" href="#table-of-contents">#</a></h2><ul><li><a href="#what-is-nextjs">What is Next.js</a></li><li><a href="#nextjs-popularity">Next.js popularity</a></li><li><a href="#why-use-nextjs-with-docker">Why use next.js with Docker</a></li><li><a href="#prerequisites">Prerequisites</a></li><li><a href="#install-nextjs-without-docker">Install Next.js without Docker</a></li><li><a href="#docker-image-for-nextjs">Docker image for Next.js</a></li><li><a href="#adding-docker-compose-for-nextjs">Adding Docker compose for Next.js</a></li><li><a href="#run-nextjs-with-docker-compose">Run Next.js with docker compose</a></li><li><a href="#conclusion">Conclusion</a></li></ul><h2 id="what-is-next.js" tabindex="-1">What is Next.js <a class="direct-link" href="#what-is-next.js">#</a></h2><p>Before going further. let’s analyze why you need Next.js as a meta-framework on top of React. The debate is that React is just a library for building UI and not a framework. There are multiple ways and other libraries to do things in React (same as JavaScript). For instance, there are at least 6 libraries to do <a href="https://blog.openreplay.com/top-6-react-state-management-libraries-for-2022/">state management in React</a>.</p><p>This is where Next.js and its opinionated decisions shine. Next.js brands itself as “The React Framework for Production” and it is open source, of course. Created by Vercel, Next.js is <a href="https://nextjs.org/showcase">reportedly</a> used by Nike, Realtor, Door Dash, and TypeForm to name some. Some features of Next.js include hybrid static and server rendering, TypeScript support, and smart bundling.</p><p>The main feature and reason for Next.js I believe is that it is React++. By that I mean,</p><blockquote><p>Next.js helps you get over the decision fatigue that comes with React (and JavaScript in general) as it makes those decisions for you to a great extent following the “best practices”.</p></blockquote><p>Don’t forget though, Next.js is a layer on top of React.js. It is the “framework” layer. For one project we worked with in 2020, the need was to do Server side rendering, and React did not do it out of the box. This is a use case to use Next.js. Unfortunately, we went with another solution but looking at hindsight Next.js would have been the best option then.</p><h2 id="next.js-popularity" tabindex="-1">Next.js popularity <a class="direct-link" href="#next.js-popularity">#</a></h2><p>Next.js is the most popular React meta-framework out there. As per NPM trends, it was downloaded 4.23 million times toward the end of Oct-2022. React is downloaded a lot more than Gatsby, Nuxt, Razzle, and Remix combined which are some of its competitors. As the picture speaks:</p><img class="center" loading="lazy" src="/images/nextjs-docker/02nextjs-popularity.jpg" title="Next.js and its popularity recently" alt="Next.js and its popularity recently"><p>If it was a popularity contest, Next.js blows the other competitor out of the water. Being backed by Vercel it is also easy to host a Next.js application on Vercel. In the next section, you will learn why to use Next.js with Docker.</p><h2 id="why-use-next.js-with-docker" tabindex="-1">Why use next.js with Docker <a class="direct-link" href="#why-use-next.js-with-docker">#</a></h2><p>Similar to Dockerizing other applications, when you put the Next.js application on a docker container it has some advantages. There first one is that you <a href="/blog/2018/11/4-ways-docker-changed-the-way-software-engineers-work-in-past-half-decade/#ship-the-whole-stack%2C-not-just-code">ship the whole stack not only your code</a>, the stack includes the OS, any other language/executables in specific versions and your code. This means you get over works on my machine syndrome.</p><p>In addition to making it portable, Docker also helps to run multiple copies of your application that can be scaled horizontally. As spinning up a docker container is relatively easy and cheap this helps with scaling your applications much easier with a container orchestrator like Kubernetes. All of these benefits surely apply to your Next.js app.</p><p>As Next.js also supports on <a href="https://nextjs.org/docs/basic-features/pages#server-side-rendering">server side rendering</a> and <a href="https://nextjs.org/docs/api-routes/introduction">API routes</a>, the applications using these features cannot be cached on the CDN. This is where if the Next.js app is Dockerized it can be easily deployed into a Kubernetes cluster or even on <a href="/blog/2023/04/serverless-containers/">serverless containers</a>.</p><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="direct-link" href="#prerequisites">#</a></h2><p>Before you jump into the code, below are some requisites:</p><ul><li>You should have Node.js installed on your system preferably the latest LTS which is Node.js v 18 at the time of writing. Similarly, some knowledge of npm and npx will also be needed.</li><li>Have Docker installed and docker-compose installed on your machine</li><li>Any prior experience with Next.js is beneficial but not necessary.</li></ul><p>In the next section, you will install Next.js without Docker and then Dockerize it.</p><h2 id="install-next.js-without-docker" tabindex="-1">Install Next.js without Docker <a class="direct-link" href="#install-next.js-without-docker">#</a></h2><p>For this tutorial, you will use the API Routes example from the official Next.js examples. You can install this example by running:</p><pre class="language-bash"><code class="language-bash">npx create-next-app <span class="token parameter variable">--example</span> api-routes api-routes-app</code></pre><p>It will show an output like the one below:</p><img class="center" loading="lazy" src="/images/nextjs-docker/04nextjs-create-app.jpg" title="Next.js create next app with API routes example CLI command" alt="Next.js create next app with API routes example CLI command"><p>To test out if the example is working properly you can execute:</p><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">cd</span> api-routes-app<br><span class="token function">npm</span> run dev</code></pre><p>It will run the server and now you can access the app at <code>http://locahost:3000</code> which will look like the following:</p><img class="center" loading="lazy" src="/images/nextjs-docker/03nextjs-running.jpg" title="Next.js running locally without Docker" alt="Next.js running locally without Docker"><p>You can click the names and play around. In the next section, you will Dockerize this example Next.js app which has APIs for the people.</p><h2 id="docker-image-for-next.js" tabindex="-1">Docker image for Next.js <a class="direct-link" href="#docker-image-for-next.js">#</a></h2><p>To Dockerize the above app, you will add the following <code>Dockerfile</code> on the root of the project:</p><pre><code>FROM node:18-alpine AS deps
RUN apk add --no-cache libc6-compat
WORKDIR /app

COPY package.json package-lock.json ./
RUN  npm install --production

FROM node:18-alpine AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .

ENV NEXT_TELEMETRY_DISABLED 1

RUN npm run build

FROM node:18-alpine AS runner
WORKDIR /app

ENV NODE_ENV production
ENV NEXT_TELEMETRY_DISABLED 1

RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

COPY --from=builder --chown=nextjs:nodejs /app/.next ./.next
COPY --from=builder /app/node_modules ./node_modules
COPY --from=builder /app/package.json ./package.json

USER nextjs

EXPOSE 3000

ENV PORT 3000

CMD [&quot;npm&quot;, &quot;start&quot;]
</code></pre><p>This is a <a href="/blog/2019/11/how-to-use-docker-multi-stage-build/">multi-stage Dockerfile</a> which starts with a <code>deps</code> stage. In this first stage which begins from the Node.js Alpine image. Then it adds <code>lib6-comat</code> package needed to build Next.js. As the stage is called deps for dependencies, in this stage the npm modules are installed next.</p><p>After that, you add the <code>builder</code> stage where the node modules are copied and the <code>npm run build</code> command is executed to build the Next.js project. You are also disabling the Next.js telemetry, this speed up the build a bit.</p><p>After that, you define the <code>runner</code> stage. This is the main stage that runs Next.js. Here you use the Node.js 18 Alpine image similar to all the above stages. Then add a group and user for Next.js. It is also important for security. After that, you copy the next folder from the <code>builder</code> stage, and node modules and package.json file. Then you define the user to be <code>nextjs</code> that will execute the command to run the Next.js project. In the end, you run <code>npm start</code> which will start the container with that command.</p><p>You can host your Next.js app with <a href="/blog/2021/01/free-nodejs-hosting/">free Node.js hosting</a> providers like Vercel. In the next part you will learn about adding Docker Compose to the Next.js app.</p><h2 id="adding-docker-compose-for-next.js" tabindex="-1">Adding Docker compose for Next.js <a class="direct-link" href="#adding-docker-compose-for-next.js">#</a></h2><p>You can run Next.js with just the above Docker file but it will be a long command. To keep things simple you will introduce a new <code>docker-compose.yml</code> file with the following contents at the root of the project:</p><pre><code>version: '3.8'
services:
  web:
    build:
      context: ./
      target: runner
    volumes:
      - .:/app
    command: npm run dev
    ports:
      - &quot;3000:3000&quot;
    environment:
      NODE_ENV: development
</code></pre><p>Here you define a service called web and the stage/target to be <code>runner</code>. You link up the local directory to <code>/app</code> on the container, this will help with hot reload on local development as the files will be overwritten locally on each save.</p><p>Then you override the command to be <code>npm run dev</code> and link up local port 3000 to container port 3000. Finally, you define the <code>NODE_ENV</code> to be <code>development</code>.</p><p>The most important detail you should remember here is, the above Docker file is production ready and Docker compose in this case is designed to be used for development only.</p><h2 id="run-next.js-with-docker-compose" tabindex="-1">Run Next.js with docker compose <a class="direct-link" href="#run-next.js-with-docker-compose">#</a></h2><p>To run the Next.js project with docker-compose you will build the docker image and then run the container. To do this you will run:</p><pre class="language-bash"><code class="language-bash"><span class="token assign-left variable">COMPOSE_DOCKER_CLI_BUILD</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">DOCKER_BUILDKIT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token function">docker-compose</span> build</code></pre><p>You are instructing docker to use Buildkit which will <a href="/blog/2020/10/docker-build-example-faster-docker-build/">speed up the docker build process</a>. The command if ran successfully will finish up as follows:</p><img class="center" loading="lazy" src="/images/nextjs-docker/05nextjs-docker-build.jpg" title="Next.js Docker build with Docker compose and build kit" alt="Next.js Docker build with Docker compose and build kit"><p>To run Next.js with Docker and docker-compose you can then run:</p><pre class="language-bash"><code class="language-bash"><span class="token function">docker-compose</span> up</code></pre><p>It will show the same output as running the app without docker when you hit <code>http://localhost:3000</code> on your favorite browser after <code>docker-compose up</code> runs without any error:</p><img class="center" loading="lazy" src="/images/nextjs-docker/03nextjs-running.jpg" title="Next.js running locally with Docker" alt="Next.js running locally with Docker"><p>If change the <code>pages/index.tsx</code> to return the following at the end of the file:</p><pre class="language-js"><code class="language-js"><span class="token keyword">return</span> <span class="token punctuation">(</span><br>  <span class="token operator">&lt;</span>div<span class="token operator">></span><br>    <span class="token operator">&lt;</span>h2<span class="token operator">></span>With Docker<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">></span><br>    <span class="token operator">&lt;</span>ul<span class="token operator">></span><br>      <span class="token punctuation">{</span>data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">p</span><span class="token operator">:</span> Person</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><br>      <span class="token operator">&lt;</span>PersonComponent key<span class="token operator">=</span><span class="token punctuation">{</span>p<span class="token punctuation">.</span>id<span class="token punctuation">}</span> person<span class="token operator">=</span><span class="token punctuation">{</span>p<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><br>      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span><br>  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><br><span class="token punctuation">)</span></code></pre><p>The changes will be picked up pretty fast and show up on the browser as follows:</p><img class="center" loading="lazy" src="/images/nextjs-docker/06nextjs-with-docker.jpg" title="Next.js running with Docker and Docker compose locally" alt="Next.js running with Docker and Docker compose locally"><p>Congrats! You have successfully Dockerized a Next.js project. As the app has been Dockerized you can run it on any service with or without Kubernetes. You can also try out <a href="/blog/2021/12/docker-postgres/">PostgreSQL with Docker</a> and Docker compose and connect it with you Next.js application.</p><p>Thank you for following along, you can find all the code of this tutorial in this <a href="https://github.com/geshan/next-js-api-routes-docker">GitHub repository</a>. For the docker-specific code please refer to this <a href="https://github.com/geshan/next-js-api-routes-docker/pull/1">pull request</a>.</p><h2 id="conclusion" tabindex="-1">Conclusion <a class="direct-link" href="#conclusion">#</a></h2><p>In this step-by-step guide, you learned about Next.js and its popularity. Then you installed one of the Next.js examples with API routes and first ran it without Docker. After that, you added the Dockerile and the docker-compose file. With the two files added you then built the docker image and then ran it locally with <code>docker-compose up</code>.</p><p>I hope you have learned how to dockerize any Next.js app. Keep learning!</p></div><div class="flex items-center justify-between gap-3 md:gap-4 flex-wrap md:flex-nowrap py-2 border-y border-lightbg mt-4"><div class="flex items-center justify-start md:gap-4 gap-2 flex-wrap w-2/3"><div class="flex justify-start items-center gap-3 md:gap-4"><img src="/images/favicons/favicon-32x32-pp.png" alt="Geshan Manandhar" class="w-10 h-10 rounded-full object-cover flex-shrink-0"> <span class="text-gray font-medium font-ui text-md md:text-xl uppercase tracking-wide text-start">Geshan Manandhar</span></div><time datetime="2023-01-08" data-updated="true"><time class="entry-date" datetime="2023-01-08"><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">08-Jan-2023 </span></time></time><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">8 MIN READ</span></div><button type="button" id="share-button-bottom" class="flex items-center justify-center w-8 h-8 md:w-9 md:h-9 rounded text-lightGray hover:border-gray-400 hover:bg-gray-50 transition-colors flex-shrink-0" aria-label="Share this post" onclick="toggleShareIconsBottom(); ga('send', 'event', 'share', 'clickShareOnPost');"><img src="/images/shareIcon.svg" alt="Share this post" class="w-6 h-6"></button></div><div id="share-icons-container-bottom" class="share-icons-bottom print:hidden hidden mx-auto" aria-label="Share this post"><div class="w-full flex items-center justify-center mx-auto gap-3"><span class="share-icons"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://geshan.com.np/blog/2023/01/nextjs-docker/" target="_blank" title="Share 'How to use Next.js with Docker and Docker compose a beginner&#39;s guide' on LinkedIn" onclick="ga('send', 'event', 'share', 'clickShareOnLinkedIn');"><span id="linkedin-share" class="text-[#0077B5]"><img src="/images/social-icons/linkedin.svg" alt="LinkedIn" class="sharing-common"> </span></a><a href="http://twitter.com/share?text=How to use Next.js with Docker and Docker compose a beginner&#39;s guide - &url=https://geshan.com.np/blog/2023/01/nextjs-docker/" target="_blank" title="Share 'How to use Next.js with Docker and Docker compose a beginner&#39;s guide' on Twitter" onclick="ga('send', 'event', 'share', 'clickShareOnTwitter');"><span id="twitter-share" class="text-[#1DA1F2]"><img src="/images/social-icons/twitter.svg" alt="Twitter" class="sharing-common"> </span></a><a href="http://www.facebook.com/sharer.php?u=https://geshan.com.np/blog/2023/01/nextjs-docker/" target="_blank" title="Share 'How to use Next.js with Docker and Docker compose a beginner&#39;s guide' on Facebook" onclick="ga('send', 'event', 'share', 'clickShareOnFacebook');"><span id="facebook-share" class="text-[#1877F2]"><img src="/images/social-icons/facebook.svg" alt="Facebook" class="sharing-common"> </span></a><a href="https://t.me/share/url?url=https://geshan.com.np/blog/2023/01/nextjs-docker/" target="_blank" title="Share 'How to use Next.js with Docker and Docker compose a beginner&#39;s guide' on Telegram" onclick="ga('send', 'event', 'share', 'clickShareOnTelegram');"><span id="telegram-share" class="text-[#0088cc]"><img src="/images/social-icons/telegram.svg" alt="Telegram" class="sharing-common"> </span></a><a href="https://api.whatsapp.com/send?text=https://geshan.com.np/blog/2023/01/nextjs-docker/" target="_blank" title="Share 'How to use Next.js with Docker and Docker compose a beginner&#39;s guide' on Whatsapp" onclick="ga('send', 'event', 'share', 'clickShareOnWhatsapp');"><span id="whatsapp-share" class="text-[#25d366]"><img src="/images/social-icons/whatsapp.svg" alt="WhatsApp" class="sharing-common"></span></a></span></div></div></article><div class="mt-3"><a href="/blog/categories/node.js/" title="Node.js" class="background-lightbg mr-4 mb-2 inline-block mt-2 rounded border-2 bg-gray-100 font-semibold font-ui text-gray hover:text-gray-400 px-3 py-1 text-xl border-gray-300 cursor-pointer hover:border-gray-400">node.js </a><a href="/blog/categories/javascript/" title="Javascript" class="background-lightbg mr-4 mb-2 inline-block mt-2 rounded border-2 bg-gray-100 font-semibold font-ui text-gray hover:text-gray-400 px-3 py-1 text-xl border-gray-300 cursor-pointer hover:border-gray-400">javascript </a><a href="/blog/categories/web-development/" title="Web Development" class="background-lightbg mr-4 mb-2 inline-block mt-2 rounded border-2 bg-gray-100 font-semibold font-ui text-gray hover:text-gray-400 px-3 py-1 text-xl border-gray-300 cursor-pointer hover:border-gray-400">web development</a></div><section class="md:w-full mx-auto mt-4"><h3 class="comments font-heading">Comments</h3><div id="disqus_thread"></div><button id="disqus_trigger" class="font-ui text-blackText hover:border-darkAvocado border-blacktext hover:shadow-lg border-2 transition ease-in-out delay-100 px-3 py-2 pt-2 mt-2 rounded-md text-center block h-auto text-xl" onclick="load_disqus()">Post a Comment</button><div id="disqus_thread" aria-live="polite"></div></section></div></div><section class="md:w-full mx-auto mt-4 bg-lightAvocado p-4 rounded-lg pb-8"><div class="max-w-6xl mx-auto md:py-12 px-4"><h2 class="text-4xl text-darkAvocado font-heading font-regular flex-shrink-0 py-8 tracking-normal leading-[105%] md:leading-[105%]"><span class="text-lightGray italic">Related</span> <span class="text-blackText">Blogs</span></h2><div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2023/03/mongodb-docker-compose/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to run MongoDB with Docker and Docker Compose a Step-by-Step guide</a> <time class="font-medium text-xl text-textColor uppercase font-ui">29-Mar-2023 &nbsp;&nbsp;&nbsp; 9 min read</time><p class="text-xl text-gray font-ui">In this step-by-step tutorial learn how to run MongoDB with Docker and Docker Compose. Also has an example with Node.js + MongoDB with Docker Compose.</p></div><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2024/11/nodejs-dotenv/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to use environment variables from a .env file in Node.js</a> <time class="font-medium text-xl text-textColor uppercase font-ui">24-Nov-2024 &nbsp;&nbsp;&nbsp; 8 min read</time><p class="text-xl text-gray font-ui">Learn how to use environment variables with the dotenv NPM package and natively with Node 20+.</p></div><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2024/10/nodejs-read-json-file/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to Read a JSON File Using Node.js</a> <time class="font-medium text-xl text-textColor uppercase font-ui">30-Oct-2024 &nbsp;&nbsp;&nbsp; 10 min read</time><p class="text-xl text-gray font-ui">Learn how to read a JSON file using Node.js. This post covers reading a JSON file synchronously and asynchronously using the fs module and fs-extra NPM package.</p></div><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2023/12/nodejs-duet-ai-vs-code/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to write and deploy a basic Node.js API with Duet AI on VS Code a step-by-step guide</a> <time class="font-medium text-xl text-textColor uppercase font-ui">18-Dec-2023 &nbsp;&nbsp;&nbsp; 9 min read</time><p class="text-xl text-gray font-ui">Learn how to write and deploy a basic Node.js API with Duet AI on VS Code, in this step-by-step tutorial with 20+ screenshots!</p></div></div></div></section><section class="bg-avocado md:py-0 py-12 px-4"><div class="max-w-6xl mx-auto"><div class="md:hidden"><h2 class="mb-4 text-3xl font-heading font-regular text-textColor break-words tracking-[-0.01em] leading-[105%] md:leading-[105%]"><span class="text-textColor italic">Stay</span><span class="text-blackText"> Connected</span></h2><p class="text-base text-blackText font-body font-regular mb-6">Follow me on LinkedIn for new posts, engineering insights, and tech takes — straight from the trenches.</p><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="inline-block bg-darkAvocado text-base text-white px-6 py-3 rounded-lg font-body font-regular hover:opacity-90 transition-opacity w-full text-center">Follow on LinkedIn &nbsp;→</a></div><div class="hidden md:grid lg:hidden grid-cols-3 gap-8 items-center"><div class="z-10 col-span-2"><h2 class="mb-4 text-2xl md:text-4xl font-heading font-regular text-textColor break-words tracking-[-0.01em] leading-[105%] md:leading-[105%]"><span class="text-textColor italic">Stay</span><span class="text-blackText"> Connected</span></h2><p class="text-xl text-blackText font-body font-regular mb-6">Follow me on LinkedIn for new posts, engineering insights, and tech takes — straight from the trenches.</p><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="inline-block bg-darkAvocado text-xl text-white px-6 py-3 rounded-lg font-body font-regular hover:opacity-90 transition-opacity">Follow on LinkedIn &nbsp;→</a></div><div class="flex items-center justify-end col-span-1"><img class="w-32 h-auto" src="/images/theme/new_logo.svg" alt="Geshan"></div></div><div class="hidden lg:grid grid-cols-2 gap-8 lg:gap-12 items-center justify-between h-full"><div class="z-10"><h2 class="mb-4 text-2xl md:text-4xl font-heading font-regular text-textColor break-words tracking-[-0.01em] leading-[105%] md:leading-[105%]"><span class="text-textColor italic">Stay</span><span class="text-blackText"> Connected</span></h2><p class="text-xl text-blackText font-body font-regular mb-6">Follow me on LinkedIn for new posts, engineering insights, and tech takes — straight from the trenches.</p><p class="text-xl text-blackText font-body font-regular mb-6">A big thank you for supporting this ad. free, unobstructive (no overlays, no pop-ups) blog.</p></div><div class="flex items-center gap-12 w-full md:w-auto justify-end self-end"><img class="w-16 md:w-32 h-auto" src="/images/theme/new_logo.svg" alt="Geshan"> <a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="inline-block bg-darkAvocado text-xl text-white px-6 py-3 rounded-lg font-body font-regular hover:opacity-90 transition-opacity w-full md:w-auto text-center md:text-left">Follow on LinkedIn &nbsp;→</a></div></div></div></section></div></div></div></main><footer role="contentinfo"><footer class="bg-avocado sm:px-4"><div class="max-w-6xl mx-auto flex flex-col md:flex-row sm:flex-col justify-between gap-2 items-center sm:items-center md:items-center py-10 font-nav text-lightGray text-base font-regular"><div class="pb-0 sm:pb-2 text-gray"><span class="pr-4">Copyright © 2026 Geshan Manandhar.</span></div><div class="pb-0 sm:pb-2"><ul class="flex"><li class="hover:text-gray-300 text-lg pr-4 cursor-pointer text-gray"><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer nofollow" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 1000 1000"><path fill="currentColor" d="M1000 267q0 112-78 188L747 631q-78 78-189 78q-97 0-171-63l115-115q26 17 56 17q44 0 75-31l175-176q31-29 31-74q0-44-30.5-74.5T734 162q-25 0-49.5 12T652 208H414L546 79Q626 1 734 1q110 0 188 78t78 188zm-387 89L498 471q-26-17-56-17q-44 0-75 31L192 661q-31 29-31 74q0 44 30.5 74.5T266 840q25 0 49.5-12t32.5-34h238L454 923q-80 78-188 78q-110 0-188-78T0 735q0-112 78-188l175-176q78-78 189-78q97 0 171 63z"/></svg> LinkedIn</a></li><li class="hover:text-gray-300 text-lg pr-4 cursor-pointer text-gray"><a href="https://www.twitter.com/geshan" target="_blank" rel="noopener noreferrer nofollow" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 1000 1000"><path fill="currentColor" d="M1000 267q0 112-78 188L747 631q-78 78-189 78q-97 0-171-63l115-115q26 17 56 17q44 0 75-31l175-176q31-29 31-74q0-44-30.5-74.5T734 162q-25 0-49.5 12T652 208H414L546 79Q626 1 734 1q110 0 188 78t78 188zm-387 89L498 471q-26-17-56-17q-44 0-75 31L192 661q-31 29-31 74q0 44 30.5 74.5T266 840q25 0 49.5-12t32.5-34h238L454 923q-80 78-188 78q-110 0-188-78T0 735q0-112 78-188l175-176q78-78 189-78q97 0 171 63z"/></svg> Twitter</a></li><li class="hover:text-gray-300 text-lg pr-4 cursor-pointer text-gray"><a href="https://github.com/geshan" target="_blank" rel="noopener noreferrer nofollow" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 1000 1000"><path fill="currentColor" d="M1000 267q0 112-78 188L747 631q-78 78-189 78q-97 0-171-63l115-115q26 17 56 17q44 0 75-31l175-176q31-29 31-74q0-44-30.5-74.5T734 162q-25 0-49.5 12T652 208H414L546 79Q626 1 734 1q110 0 188 78t78 188zm-387 89L498 471q-26-17-56-17q-44 0-75 31L192 661q-31 29-31 74q0 44 30.5 74.5T266 840q25 0 49.5-12t32.5-34h238L454 923q-80 78-188 78q-110 0-188-78T0 735q0-112 78-188l175-176q78-78 189-78q97 0 171 63z"/></svg> Github</a></li></ul></div></div></footer></footer><script src="/js/all.min.js" defer="defer"></script></body></html>