<!doctype html><html class="no-js" lang="en"><head><meta charset="utf-8"><meta name="author" content="Geshan Manandhar"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="In this tutorial you will learn how to set up and use ON DELETE CASCADE in Postgres with a working example of Author and Quotes."><meta name="keywords" content="delete cascade postgres, postgres delete cascade, postgresql delete cascade, delete cascade postgresql"><meta name="p:domain_verify" content="e654c68562abebfa25c291f59d7d00e8"><meta property="og:type" content="website"><meta property="og:url" content="https://geshan.com.np/blog/2023/04/delete-cascade-postgres/"><meta property="og:title" content="How to use ON DELETE CASCADE in Postgres with an example"><meta property="og:description" content="In this tutorial you will learn how to set up and use ON DELETE CASCADE in Postgres with a working example of Author and Quotes."><meta property="og:site_name" content="Geshan&#39;s Blog"><meta property="og:image" content="https://geshan.com.np/images/delete-cascade-postgres/01delete-cascade-postgres.jpg"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:widgets:new-embed-design" content="on"><meta name="twitter:site" content="@geshan"><meta name="twitter:creator" content="@geshan"><meta name="twitter:title" content="How to use ON DELETE CASCADE in Postgres with an example"><meta name="twitter:description" content="In this tutorial you will learn how to set up and use ON DELETE CASCADE in Postgres with a working example of Author and Quotes."><meta name="twitter:image:src" content="https://geshan.com.np/images/delete-cascade-postgres/01delete-cascade-postgres.jpg"><link rel="canonical" href="https://geshan.com.np/blog/2023/04/delete-cascade-postgres/"><meta property="fb:pages" content="30717799226"><meta property="fb:app_id" content="106030259434380"><meta name="monetization" content="$ilp.uphold.com/aKHWpqhphm9f"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png"><link href="/atom.xml" rel="alternate" title="Geshan&#39;s Blog" type="application/atom+xml"><title>How to use ON DELETE CASCADE in Postgres with an example</title><link rel="preconnect" href="/" crossorigin><link rel="preload" href="/css/fonts.css" as="style"><link rel="preload" href="/fonts/source-sans-4/source-serif-4-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/fonts/source-sans-4/source-serif-4-latin-500-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/fonts/source-sans-pro/source-sans-pro-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="/css/fonts.css"><link rel="stylesheet" href="/css/tw-006.css"><link rel="alternate" href="/atom.xml" type="application/atom+xml" title="Geshan&#39;s Blog"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-P3NXCVQEPE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-P3NXCVQEPE');</script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWT2D9T');</script><script src="https://cdn.jsdelivr.net/npm/@statsig/js-client@3/build/statsig-js-client+session-replay+web-analytics.min.js?apikey=client-rYO7rX8WSUyyLg9pKJwymLxM71tCE0CKgxgtUj4akzK"></script><link rel="manifest" href="/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="application-name" content="Geshan.com.np"><meta name="apple-mobile-web-app-title" content="Geshan.com.np"><meta name="msapplication-starturl" content="/index.html"><meta name="theme-color" content="#6947E7"><script>if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/sw.js").then(function(registration) {
        console.log('ServiceWorker registration successful with scope: ', registration.scope);
    }, function(err) {
        console.log('ServiceWorker registration failed: ', err);
    });
  }</script></head><body class="overflow-x-hidden font-ui flex flex-col min-h-screen"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWT2D9T" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><header role="banner"><div><nav class="bg-white" role="navigation"><div class="w-full md:max-w-6xl mx-auto py-4 px-4"><div class="flex items-center justify-between h-16"><div class="flex-shrink-0"><a href="/" class="flex items-center"><img class="h-12 w-12" src="/images/theme/new_logo.svg" alt="Geshan G"></a></div><div class="flex items-center gap-12"><div class="hidden sm:flex items-center gap-12"><a href="/posts/1/" class="uppercase text-base font-ui font-medium text-gray hover:text-midgrey transition-colors" aria-current="page">Posts </a><a href="/about/" class="uppercase text-base font-ui font-medium text-gray hover:text-midgrey transition-colors" aria-current="page">About Me </a><a href="https://newsletter.geshan.com.np/" class="uppercase text-base font-ui font-medium text-gray hover:text-midgrey transition-colors" aria-current="page">Newsletter</a></div><form class="search flex items-center" action="https://www.google.com/search" method="GET"><input type="hidden" name="sitesearch" value="geshan.com.np"><div class="relative"><input class="bg-gray-100 border border-neutralGray rounded-lg py-2 pl-10 pr-4 font-body text-sm focus:outline-none focus:ring-2 focus:ring-avocado focus:border-transparent w-40" type="text" name="q" placeholder="Search" label="search"> <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-neutralGray" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg></div></form><button type="button" class="sm:hidden inline-flex items-center justify-center p-2 rounded-md text-black focus:outline-none focus:ring-2 focus:ring-inset focus:ring-avocado" onclick="mobileView()" aria-controls="mobile-menu" aria-expanded="false"><span class="sr-only">Open main menu</span> <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button></div></div></div><div class="mobile-menu fixed inset-0 z-40 hidden sm:hidden bg-black bg-opacity-40" role="dialog" aria-modal="true"><div class="absolute inset-0" onclick="mobileView()" aria-hidden="true"></div><div class="mobile-menu-panel relative ml-auto flex h-full w-10/12 max-w-sm flex-col justify-start bg-white shadow-xl"><div class="flex items-center justify-between px-4 py-4 border-b border-gray-200"><div class="flex items-center gap-3"><img class="h-8 w-8" src="/images/theme/new_logo.svg" alt="Geshan G"> <span class="text-lg font-semibold text-textColor font-body">Geshan's Blog</span></div><button type="button" class="inline-flex items-center justify-center rounded-full p-2 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-avocado" onclick="mobileView()" aria-label="Close main menu"><svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button></div><nav class="overflow-y-auto px-4 py-6 space-y-2"><a href="/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">Home </a><a href="/posts/1/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">Posts </a><a href="/about/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">About Me </a><a href="https://newsletter.geshan.com.np/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">Newsletter</a></nav><div class="px 4 py-4 border-t border-gray-200"><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="rounded-lg bg-darkAvocado px-4 py-2 text-base font-regular font-body text-white hover:bg-avocado hover:text-black transition-colors w-2/3 mx-auto ml-4">Connect on LinkedIn</a></div></div></div></nav></div></header><main id="wrap" role="main" class="flex-grow md:px-0"><div id="content"><div class="row"><div><script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Geshan&#39;s Blog",
    "alternativeHeadline": "How to use ON DELETE CASCADE in Postgres with an example",
    "image": "https://geshan.com.np/images/delete-cascade-postgres/01delete-cascade-postgres.jpg",
    "editor": "Geshan Manandhar",
    "genre": "Software Engineering",
    "keywords": "delete cascade postgres, postgres delete cascade, postgresql delete cascade, delete cascade postgresql",
    "url": "https://geshan.com.np/blog/2023/04/delete-cascade-postgres/",
    "datePublished": "2023-04-29",
    "dateCreated": "2023-04-29",
    "dateModified": "2023-04-29",
    "description": "In this tutorial you will learn how to set up and use ON DELETE CASCADE in Postgres with a working example of Author and Quotes.",
    "articleBody": "Postgres is one of the most popular open-source relational database systems in use today. One of the useful features of PostgreSQL is on delete cascade that simplifies the code in your application. In this guide, you will learn how to set up and use  some code After deleting the author with id 2 (Bjarne Stroustrup) due to the ON DELETE CASCADE in place it would delete the two quotes too as seen in the output below:Congrats! Now you understand how the domino effect of ON DELETE CASCADE works in Postgres. It is a similar concept in other relational database systems like MySQL.Conclusion #In this tutorial, you learned how to set up an ON DELETE CASCADE with a foreign key in Postgres using the example of one Author having multiple Quotes schema. After that, you added some example data and then deleted an author to see the effect of ON DELETE CASCADE. In effect, it deleted the related quotes for the deleted author from the database server level without adding any more application-level code.I hope you learned how ON DELETE CASCADE works on Postgres, it is a similar approach in other relations databases too.",
    "author": { "@type": "Person", "name": "Geshan Manandhar" },
    "publisher": {
      "@type": "Organization",
      "name": "Geshan Manandhar",
      "logo": { "@type": "ImageObject", "url": "https://geshan.com.np/images/favicons/favicon-32x32.png" }
    },
    "mainEntityOfPage": { "@type": "WebPage", "@id": "https://geshan.com.np/blog/2023/04/delete-cascade-postgres/" }
  }</script><div class="progress-bar"></div><div class="max-w-6xl py-3 mx-auto grid-cols-12 grid gap-15 px-4 md:px-0 mb-20"><div class="col-span-12"><article class="md:w-full mx-auto"><header class="page-header text-center"><h1 class="font-semibold font-heading text-gray text-center mb-6 tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to use ON DELETE CASCADE in Postgres with an example</h1><div class="flex items-center justify-between gap-3 md:gap-4 flex-wrap md:flex-nowrap py-2 border-y border-lightbg mt-4"><div class="flex items-center justify-start md:gap-4 gap-2 flex-wrap w-2/3"><div class="flex justify-start items-center gap-3 md:gap-4"><img src="/images/favicons/favicon-32x32-pp.png" alt="Geshan Manandhar" class="w-10 h-10 rounded-full object-cover flex-shrink-0"> <span class="text-gray font-medium font-ui text-md md:text-xl uppercase tracking-wide text-start">Geshan Manandhar</span></div><time datetime="2023-04-29" data-updated="true"><time class="entry-date" datetime="2023-04-29"><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">29-Apr-2023 </span></time></time><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">10 MIN READ</span></div><button type="button" id="share-button" class="flex items-center justify-center w-8 h-8 md:w-9 md:h-9 rounded text-lightGray hover:border-gray-400 hover:bg-gray-50 transition-colors flex-shrink-0" aria-label="Share this post" onclick="toggleShareIcons(); ga('send', 'event', 'share', 'clickShareOnPost');"><img src="/images/shareIcon.svg" alt="Share this post" class="w-6 h-6"></button></div><div id="share-icons-container" class="share-icons print:hidden hidden" aria-label="Share this post"><div class="flex items-center justify-center gap-3"><span class="share-icons"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://geshan.com.np/blog/2023/04/delete-cascade-postgres/" target="_blank" title="Share 'How to use ON DELETE CASCADE in Postgres with an example' on LinkedIn" onclick="ga('send', 'event', 'share', 'clickShareOnLinkedIn');"><span id="linkedin-share" class="text-[#0077B5]"><img src="/images/social-icons/linkedin.svg" alt="LinkedIn" class="sharing-common"> </span></a><a href="http://twitter.com/share?text=How to use ON DELETE CASCADE in Postgres with an example - &url=https://geshan.com.np/blog/2023/04/delete-cascade-postgres/" target="_blank" title="Share 'How to use ON DELETE CASCADE in Postgres with an example' on Twitter" onclick="ga('send', 'event', 'share', 'clickShareOnTwitter');"><span id="twitter-share" class="text-[#1DA1F2]"><img src="/images/social-icons/twitter.svg" alt="Twitter" class="sharing-common"> </span></a><a href="http://www.facebook.com/sharer.php?u=https://geshan.com.np/blog/2023/04/delete-cascade-postgres/" target="_blank" title="Share 'How to use ON DELETE CASCADE in Postgres with an example' on Facebook" onclick="ga('send', 'event', 'share', 'clickShareOnFacebook');"><span id="facebook-share" class="text-[#1877F2]"><img src="/images/social-icons/facebook.svg" alt="Facebook" class="sharing-common"> </span></a><a href="https://t.me/share/url?url=https://geshan.com.np/blog/2023/04/delete-cascade-postgres/" target="_blank" title="Share 'How to use ON DELETE CASCADE in Postgres with an example' on Telegram" onclick="ga('send', 'event', 'share', 'clickShareOnTelegram');"><span id="telegram-share" class="text-[#0088cc]"><img src="/images/social-icons/telegram.svg" alt="Telegram" class="sharing-common"> </span></a><a href="https://api.whatsapp.com/send?text=https://geshan.com.np/blog/2023/04/delete-cascade-postgres/" target="_blank" title="Share 'How to use ON DELETE CASCADE in Postgres with an example' on Whatsapp" onclick="ga('send', 'event', 'share', 'clickShareOnWhatsapp');"><span id="whatsapp-share" class="text-[#25d366]"><img src="/images/social-icons/whatsapp.svg" alt="WhatsApp" class="sharing-common"></span></a></span></div></div></header><div class="entry-content clearfix font-body text-xl text-gray"><p>Postgres is one of the most <a href="https://db-engines.com/en/system/PostgreSQL">popular</a> open-source relational database systems in use today. One of the useful features of PostgreSQL is on delete cascade that simplifies the code in your application. In this guide, you will learn how to set up and use <code>ON DELETE CASCADE</code> in foreign keys in Postgres, let’s get going!</p><img class="center" loading="lazy" src="/images/delete-cascade-postgres/01delete-cascade-postgres.jpg" title="Learn how to use ON DELETE CASCADE in Postgres" alt="Learn how to use ON DELETE CASCADE in Postgres"><h2 id="table-of-contents" tabindex="-1">Table of contents <a class="direct-link" href="#table-of-contents">#</a></h2><ul><li><a href="#prerequisites">Prerequisites</a></li><li><a href="#author-and-quotes-example">Author and Quotes example</a><ul><li><a href="#on-delete-cascade-or-something-else">ON DELETE CASCADE or something else</a></li><li><a href="#create-tables-on-elephantsql">Create tables on ElephantSQL</a></li><li><a href="#insert-data-in-created-tables">Insert data in created tables</a></li><li><a href="#delete-an-author-row">Delete an author row</a></li><li><a href="#check-the-on-delete-cascade-has-worked">Check the ON DELETE CASCADE has worked</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li></ul><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="direct-link" href="#prerequisites">#</a></h2><p>Before diving into the SQL code, below are some prerequisites for this tutorial:</p><ol><li>You should have a working Postgres server instance to test your code. You can use a local <a href="/blog/2021/12/docker-postgres/">Postgres Docker</a> instance or simply use a free database on <a href="https://www.elephantsql.com/plans.html">Elephant SQL</a> or <a href="https://neon.tech/">Neon.tech</a></li><li>Prior experience with any relations database management system (RDBMS) would be helpful.</li><li>Previous understanding of how foreign keys work in RDBMS will be advantageous</li><li>Being able to read Entity Relationship (ER) diagrams will make it easier for you to understand the context.</li></ol><p>Given that is mentioned, you can continue with the guide now.</p><h2 id="author-and-quotes-example" tabindex="-1">Author and Quotes example <a class="direct-link" href="#author-and-quotes-example">#</a></h2><p>For this tutorial, you will use an example of an author and quotes. One author can have multiple quotes and one quote will always have only one author. It can be represented in an ER diagram as follows (diagram generated with <a href="http://dbdiagram.io">dbdiagram.io</a>):</p><img class="center" loading="lazy" src="/images/delete-cascade-postgres/02author-quotes-er.jpg" title="Entity relationship (ER) diagram of Author and Quotes relationship" alt="Entity relationship (ER) diagram of Author and Quotes relationship"><p>In terms of Postgres Data Definition Language (DDL), the above ER diagram with two related entities translates to the following create table statements:</p><pre class="language-sql"><code class="language-sql"><span class="highlight-line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> author <span class="token punctuation">(</span></span><br><span class="highlight-line">    id <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    name <span class="token keyword">character</span> <span class="token keyword">varying</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    created_at <span class="token keyword">timestamp</span> <span class="token keyword">with</span> <span class="token keyword">time</span> zone <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    updated_at <span class="token keyword">timestamp</span> <span class="token keyword">with</span> <span class="token keyword">time</span> zone <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span></span><br><span class="highlight-line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> quote <span class="token punctuation">(</span></span><br><span class="highlight-line">    id <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    quote <span class="token keyword">character</span> <span class="token keyword">varying</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span></span><br><mark class="highlight-line highlight-line-active">    author_id <span class="token keyword">INTEGER</span> <span class="token keyword">REFERENCES</span> author<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">,</span></mark><br><span class="highlight-line">    created_at <span class="token keyword">timestamp</span> <span class="token keyword">with</span> <span class="token keyword">time</span> zone <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    updated_at <span class="token keyword">timestamp</span> <span class="token keyword">with</span> <span class="token keyword">time</span> zone <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span></span><br><span class="highlight-line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>There are two entities (tables) <code>author</code> and <code>quote</code>. The author table has 4 columns; id, name, created_at, and udpated_at. <code>ID</code> is a serial which is an integer autoincremented by 1 and the primary key of the table. The <code>name</code> column is a varying character that can be up to 255 characters and cannot be null, it holds the author's name. The <code>created_at</code> and <code>updated_at</code> columns are timestamp columns by default have the current timestamp.</p><p>The <code>quote</code> entity (table) also has an integer serial primary key similar to the <code>author</code> table. Then, it has a <code>quote</code> column that can hold up to 255 characters and always needs a value. The interesting column is the foreign key to the <code>author</code> table called <code>author_id</code> as highlighed above.</p><p>The <code>auhtor_id</code> foreign key column is an integer and refers to the <code>id</code> column on the author. The main point here is it has <code>ON DELETE CASCADE</code> which means when an author is deleted all the related quotes will also be deleted. This is like a domino effect when the parent row is deleted all its child rows are deleted too.</p><p>Depending on how <code>ON DELETE CASCADE</code> is added on relational databases like Postgres, deleting one row on table A can delete related rows on table B, similarly deleting one row on table B can delete related rows on table C. This creates a ripple effect that can delete many related children and children of children rows. So you have to be careful about how to set up on delete cascade.</p><p>After the <code>author_id</code> column, the <code>quote</code> table has <code>created_at</code> and <code>updated_at</code> similar to the columns with the same name on the <code>author</code> table.</p><h3 id="on-delete-cascade-or-something-else" tabindex="-1">ON DELETE CASCADE or something else <a class="direct-link" href="#on-delete-cascade-or-something-else">#</a></h3><p>To delete the related child rows for a parent row, there are mainly two ways. The first is to let the database server delete the related child rows with <code>ON DELETE CASCADE</code>. The second is not deleting the child rows from the database server with RESTRICT or NO ACTION. You can read more about it on the <a href="https://www.postgresql.org/docs/current/ddl-constraints.html#:~:text=Restricting%20and%20cascading%20deletes%20are,you%20do%20not%20specify%20anything.">official docs</a> of Postgres.</p><p>If you choose to not delete the rows on the database server level, you will have to delete all the child rows manually from your application before the parent row(s) can be deleted. Like most things in tech, there are tradeoffs for both approaches. You should understand the implications of using the ripple/domino effect on the database level or manually deleting the child rows from the application so that the parent row can be deleted without any errors.</p><p>When you create records with relationships you must create the parent first then the child and its child. In case of delete, you have to delete the leaf (last level children), the branches (children) and then only delete the parent (root). It can be understood with a diagram better:</p><img class="center" loading="lazy" src="/images/delete-cascade-postgres/03create-delete.jpg" title="How to create and delete records in a one to many parent child relationship" alt="How to create and delete records in a one to many parent child relationship"><p>Depending on how much data there is on the database and which database engine (if any) the database server uses, sometimes it might be wiser to not have strict foreign keys. If you want to add a column to a table with a million rows that have a child table with billion rows, things would get complicated quite quickly when the foreign keys are strict and could block both the tables while running the <code>ALTER TABLE</code> script.</p><p>In the next section, you will see how to create the above tables and insert some data. Then delete one parent row and see that its child rows are automatically deleted due to the ON DELETE CASCADE instruction on the foreign key.</p><h3 id="create-tables-on-elephantsql" tabindex="-1">Create tables on ElephantSQL <a class="direct-link" href="#create-tables-on-elephantsql">#</a></h3><p>For this example, you will use ElephantSQL, you can follow their <a href="https://www.elephantsql.com/docs/index.html">documentation</a> to create an empty database for free. Create a new free database named something like <code>quotes-author-01</code> and go to the “Browser” section and run the above create table statements using the blue &quot;Execute&quot; button as seen below:</p><img class="center" loading="lazy" src="/images/delete-cascade-postgres/04create-tables.jpg" title="Create tables author and quote with in a one to many parent child relationship" alt="reate tables author and quote with in a one to many parent child relationship"><p>The above SQL statements will create two tables author and quotes. The main point to focus on here is the <code>author_id INTEGER REFERENCES author(id) ON DELETE CASCADE,</code> which sets up the ON DELETE CASCADE mechanism. So, whenever any author row is deleted, any related quote rows will also be deleted. Let’s see how that happens in the next section.</p><h3 id="insert-data-in-created-tables" tabindex="-1">Insert data in created tables <a class="direct-link" href="#insert-data-in-created-tables">#</a></h3><p>To delete data you will need to add some data to the two tables. To add data in the <code>author</code> and <code>quote</code> table created in the previous section, please run the following on the same “Browser” screen on ElephantSQL (you can run them on your local Postgres instance too).</p><pre class="language-sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> author<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <br><span class="token punctuation">(</span><span class="token string">'Martin Fowler'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br><span class="token punctuation">(</span><span class="token string">'Bjarne Stroustrup'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br><span class="token punctuation">(</span><span class="token string">'John Johnson'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br> <br> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> quote <span class="token punctuation">(</span>quote<span class="token punctuation">,</span> author_id<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><br> <span class="token punctuation">(</span><span class="token string">'Any fool can write code that a computer can understand. Good programmers write code that humans can understand.'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br> <span class="token punctuation">(</span><span class="token string">'If you have to spend effort looking at a fragment of code and figuring out what it is doing, then you should extract it into a function and name the function after the "what".'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br> <span class="token punctuation">(</span><span class="token string">'There are only two kinds of languages: the ones people complain about and the ones nobody uses.'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br> <span class="token punctuation">(</span><span class="token string">'If you think it is simple, then you have misunderstood the problem.'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br> <span class="token punctuation">(</span><span class="token string">'First, solve the problem. Then, write the code.'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>It will look like the below when the insert statements are executed successfully:</p><img class="center" loading="lazy" src="/images/delete-cascade-postgres/05insert-data.jpg" title="Insert data on tables author and quote" alt="Insert data on tables author and quote"><p>To make sure that the insert statements have worked correctly, you can run the following SELECT statement and see all the relevant data joining both the author and quote table:</p><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> q<span class="token punctuation">.</span>id<span class="token punctuation">,</span> q<span class="token punctuation">.</span>quote<span class="token punctuation">,</span> a<span class="token punctuation">.</span>name<span class="token punctuation">,</span> a<span class="token punctuation">.</span>id <span class="token keyword">as</span> author_id<span class="token punctuation">,</span> q<span class="token punctuation">.</span>created_at <br><span class="token keyword">FROM</span> quote q <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> author a <span class="token keyword">on</span> a<span class="token punctuation">.</span>id <span class="token operator">=</span> q<span class="token punctuation">.</span>author_id<span class="token punctuation">;</span></code></pre><p>It is a simple inner join between the <code>author</code> and <code>quote</code> table using the <code>author_id</code> foreign key. The output of the above SELECT statement will look as follows:</p><img class="center" loading="lazy" src="/images/delete-cascade-postgres/06select-data-before-delete.jpg" title="Select data before ON CASCADE DELETE with 5 rows" alt="Select data before ON CASCADE DELETE with 5 rows"><p>Now given the test data is inserted into both tables, In the next section, you will delete an author row and see that it deletes the related quote rows as well.</p><h3 id="delete-an-author-row" tabindex="-1">Delete an author row <a class="direct-link" href="#delete-an-author-row">#</a></h3><p>Now, it is time to test the <code>ON DELETE CASCADE</code> in action. To verify that the cascade deleting works as expected and will delete the quotes related to the author you will delete the author with id 2 which is Bjarne Stourstrup. This DELETE statement will delete one row in the <code>author</code> table and also delete 2 more rows in the <code>quote</code> table. It will happen because you have set up the <code>ON DELETE CASCADE</code> on the foreign key from the <code>quote</code> table to the <code>author</code> table. To delete the row with id 2 on the author, you can run the following statement on the “Browser” screen on ElephantSQL:</p><pre class="language-sql"><code class="language-sql"><span class="token keyword">DELETE</span> <span class="token keyword">from</span> author <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment"># Bjarne Stroustrup</span></code></pre><p>When it executes without errors, it will look as follows:</p><img class="center" loading="lazy" src="/images/delete-cascade-postgres/07on-delete-cascade.jpg" title="Delete author with id 2" alt="Delete author with id 2"><p>You have successfully deleted row id 2 on the author, the row for Bjarne Stroustrup. Now it should have deleted the two quotes by Bjarne which is described in the next section.</p><h3 id="check-the-on-delete-cascade-has-worked" tabindex="-1">Check the ON DELETE CASCADE has worked <a class="direct-link" href="#check-the-on-delete-cascade-has-worked">#</a></h3><p>The author Bjarne Stroustrup with id 2 had two quotes on the quote table with ids 3 and 4. To check that both the related quotes are deleted when the author is deleted you can again run the following select statement that joins those two tables:</p><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> q<span class="token punctuation">.</span>id<span class="token punctuation">,</span> q<span class="token punctuation">.</span>quote<span class="token punctuation">,</span> a<span class="token punctuation">.</span>name<span class="token punctuation">,</span> a<span class="token punctuation">.</span>id <span class="token keyword">as</span> author_id<span class="token punctuation">,</span> q<span class="token punctuation">.</span>created_at <br><span class="token keyword">FROM</span> quote q <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> author a <span class="token keyword">on</span> a<span class="token punctuation">.</span>id <span class="token operator">=</span> q<span class="token punctuation">.</span>author_id<span class="token punctuation">;</span></code></pre><p>After deleting the author with id 2 (Bjarne Stroustrup) due to the ON DELETE CASCADE in place it would delete the two quotes too as seen in the output below:</p><img class="center" loading="lazy" src="/images/delete-cascade-postgres/08after-delete.jpg" title="After ON DELETE CASCADE related quotes of the author id 2 is deleted too" alt="After ON DELETE CASCADE related quotes of the author id 2 is deleted too"><p>Congrats! Now you understand how the domino effect of ON DELETE CASCADE works in Postgres. It is a similar concept in other relational database systems like MySQL.</p><h2 id="conclusion" tabindex="-1">Conclusion <a class="direct-link" href="#conclusion">#</a></h2><p>In this tutorial, you learned how to set up an ON DELETE CASCADE with a foreign key in Postgres using the example of one Author having multiple Quotes schema. After that, you added some example data and then deleted an author to see the effect of ON DELETE CASCADE. In effect, it deleted the related quotes for the deleted author from the database server level without adding any more application-level code.</p><p>I hope you learned how ON DELETE CASCADE works on Postgres, it is a similar approach in other relations databases too.</p></div><div class="flex items-center justify-between gap-3 md:gap-4 flex-wrap md:flex-nowrap py-2 border-y border-lightbg mt-4"><div class="flex items-center justify-start md:gap-4 gap-2 flex-wrap w-2/3"><div class="flex justify-start items-center gap-3 md:gap-4"><img src="/images/favicons/favicon-32x32-pp.png" alt="Geshan Manandhar" class="w-10 h-10 rounded-full object-cover flex-shrink-0"> <span class="text-gray font-medium font-ui text-md md:text-xl uppercase tracking-wide text-start">Geshan Manandhar</span></div><time datetime="2023-04-29" data-updated="true"><time class="entry-date" datetime="2023-04-29"><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">29-Apr-2023 </span></time></time><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">10 MIN READ</span></div><button type="button" id="share-button-bottom" class="flex items-center justify-center w-8 h-8 md:w-9 md:h-9 rounded text-lightGray hover:border-gray-400 hover:bg-gray-50 transition-colors flex-shrink-0" aria-label="Share this post" onclick="toggleShareIconsBottom(); ga('send', 'event', 'share', 'clickShareOnPost');"><img src="/images/shareIcon.svg" alt="Share this post" class="w-6 h-6"></button></div><div id="share-icons-container-bottom" class="share-icons-bottom print:hidden hidden mx-auto" aria-label="Share this post"><div class="w-full flex items-center justify-center mx-auto gap-3"><span class="share-icons"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://geshan.com.np/blog/2023/04/delete-cascade-postgres/" target="_blank" title="Share 'How to use ON DELETE CASCADE in Postgres with an example' on LinkedIn" onclick="ga('send', 'event', 'share', 'clickShareOnLinkedIn');"><span id="linkedin-share" class="text-[#0077B5]"><img src="/images/social-icons/linkedin.svg" alt="LinkedIn" class="sharing-common"> </span></a><a href="http://twitter.com/share?text=How to use ON DELETE CASCADE in Postgres with an example - &url=https://geshan.com.np/blog/2023/04/delete-cascade-postgres/" target="_blank" title="Share 'How to use ON DELETE CASCADE in Postgres with an example' on Twitter" onclick="ga('send', 'event', 'share', 'clickShareOnTwitter');"><span id="twitter-share" class="text-[#1DA1F2]"><img src="/images/social-icons/twitter.svg" alt="Twitter" class="sharing-common"> </span></a><a href="http://www.facebook.com/sharer.php?u=https://geshan.com.np/blog/2023/04/delete-cascade-postgres/" target="_blank" title="Share 'How to use ON DELETE CASCADE in Postgres with an example' on Facebook" onclick="ga('send', 'event', 'share', 'clickShareOnFacebook');"><span id="facebook-share" class="text-[#1877F2]"><img src="/images/social-icons/facebook.svg" alt="Facebook" class="sharing-common"> </span></a><a href="https://t.me/share/url?url=https://geshan.com.np/blog/2023/04/delete-cascade-postgres/" target="_blank" title="Share 'How to use ON DELETE CASCADE in Postgres with an example' on Telegram" onclick="ga('send', 'event', 'share', 'clickShareOnTelegram');"><span id="telegram-share" class="text-[#0088cc]"><img src="/images/social-icons/telegram.svg" alt="Telegram" class="sharing-common"> </span></a><a href="https://api.whatsapp.com/send?text=https://geshan.com.np/blog/2023/04/delete-cascade-postgres/" target="_blank" title="Share 'How to use ON DELETE CASCADE in Postgres with an example' on Whatsapp" onclick="ga('send', 'event', 'share', 'clickShareOnWhatsapp');"><span id="whatsapp-share" class="text-[#25d366]"><img src="/images/social-icons/whatsapp.svg" alt="WhatsApp" class="sharing-common"></span></a></span></div></div></article><div class="mt-3"><a href="/blog/categories/software-engineering/" title="Software Engineering" class="background-lightbg mr-4 mb-2 inline-block mt-2 rounded border-2 bg-gray-100 font-semibold font-ui text-gray hover:text-gray-400 px-3 py-1 text-xl border-gray-300 cursor-pointer hover:border-gray-400">software engineering </a><a href="/blog/categories/postgres/" title="Postgres" class="background-lightbg mr-4 mb-2 inline-block mt-2 rounded border-2 bg-gray-100 font-semibold font-ui text-gray hover:text-gray-400 px-3 py-1 text-xl border-gray-300 cursor-pointer hover:border-gray-400">postgres</a></div><section class="md:w-full mx-auto mt-4"><h3 class="comments font-heading">Comments</h3><div id="disqus_thread"></div><button id="disqus_trigger" class="font-ui text-blackText hover:border-darkAvocado border-blacktext hover:shadow-lg border-2 transition ease-in-out delay-100 px-3 py-2 pt-2 mt-2 rounded-md text-center block h-auto text-xl" onclick="load_disqus()">Post a Comment</button><div id="disqus_thread" aria-live="polite"></div></section></div></div><section class="md:w-full mx-auto mt-4 bg-lightAvocado p-4 rounded-lg pb-8"><div class="max-w-6xl mx-auto md:py-12 px-4"><h2 class="text-4xl text-darkAvocado font-heading font-regular flex-shrink-0 py-8 tracking-normal leading-[105%] md:leading-[105%]"><span class="text-lightGray italic">Related</span> <span class="text-blackText">Blogs</span></h2><div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2024/12/postgres-insert-on-conflict-update/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to Upsert Data in Postgres Using INSERT ON CONFLICT UPDATE</a> <time class="font-medium text-xl text-textColor uppercase font-ui">14-Dec-2024 &nbsp;&nbsp;&nbsp; 9 min read</time><p class="text-xl text-gray font-ui">Learn how to upsert data in Postgres using the INSERT ON CONFLICT UPDATE clause with practical examples. Combine insert and update operations into one UPSERT.</p></div><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2024/08/postgres-insert-multiple-rows/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to insert multiple rows in Postgres using two useful methods</a> <time class="font-medium text-xl text-textColor uppercase font-ui">14-Aug-2024 &nbsp;&nbsp;&nbsp; 10 min read</time><p class="text-xl text-gray font-ui">Learn to insert multiple rows at once in Postgres with a single insert statement and the copy command in this useful tutorial.</p></div><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2024/05/postgres-rename-column/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to rename a column in Postgres, from a simple to a real-life example</a> <time class="font-medium text-xl text-textColor uppercase font-ui">26-May-2024 &nbsp;&nbsp;&nbsp; 7 min read</time><p class="text-xl text-gray font-ui">Learn how to rename a column in Postgres from a simple alter table rename column to a zero downtime real-life example.</p></div><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2023/10/postgres-string_agg/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to use the string_agg function in Postgres with examples</a> <time class="font-medium text-xl text-textColor uppercase font-ui">27-Oct-2023 &nbsp;&nbsp;&nbsp; 12 min read</time><p class="text-xl text-gray font-ui">Learn how to use Postgres string_agg function with examples of top 100 billionaires in the world, pretty fun!</p></div></div></div></section><section class="bg-avocado md:py-0 py-12 px-4"><div class="max-w-6xl mx-auto"><div class="md:hidden"><h2 class="mb-4 text-3xl font-heading font-regular text-textColor break-words tracking-[-0.01em] leading-[105%] md:leading-[105%]"><span class="text-textColor italic">Stay</span><span class="text-blackText"> Connected</span></h2><p class="text-base text-blackText font-body font-regular mb-6">Follow me on LinkedIn for new posts, engineering insights, and tech takes — straight from the trenches.</p><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="inline-block bg-darkAvocado text-base text-white px-6 py-3 rounded-lg font-body font-regular hover:opacity-90 transition-opacity w-full text-center">Follow on LinkedIn &nbsp;→</a></div><div class="hidden md:grid lg:hidden grid-cols-3 gap-8 items-center"><div class="z-10 col-span-2"><h2 class="mb-4 text-2xl md:text-4xl font-heading font-regular text-textColor break-words tracking-[-0.01em] leading-[105%] md:leading-[105%]"><span class="text-textColor italic">Stay</span><span class="text-blackText"> Connected</span></h2><p class="text-xl text-blackText font-body font-regular mb-6">Follow me on LinkedIn for new posts, engineering insights, and tech takes — straight from the trenches.</p><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="inline-block bg-darkAvocado text-xl text-white px-6 py-3 rounded-lg font-body font-regular hover:opacity-90 transition-opacity">Follow on LinkedIn &nbsp;→</a></div><div class="flex items-center justify-end col-span-1"><img class="w-32 h-auto" src="/images/theme/new_logo.svg" alt="Geshan"></div></div><div class="hidden lg:grid grid-cols-2 gap-8 lg:gap-12 items-center justify-between h-full"><div class="z-10"><h2 class="mb-4 text-2xl md:text-4xl font-heading font-regular text-textColor break-words tracking-[-0.01em] leading-[105%] md:leading-[105%]"><span class="text-textColor italic">Stay</span><span class="text-blackText"> Connected</span></h2><p class="text-xl text-blackText font-body font-regular mb-6">Follow me on LinkedIn for new posts, engineering insights, and tech takes — straight from the trenches.</p><p class="text-xl text-blackText font-body font-regular mb-6">A big thank you for supporting this ad. free, unobstructive (no overlays, no pop-ups) blog.</p></div><div class="flex items-center gap-12 w-full md:w-auto justify-end self-end"><img class="w-16 md:w-32 h-auto" src="/images/theme/new_logo.svg" alt="Geshan"> <a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="inline-block bg-darkAvocado text-xl text-white px-6 py-3 rounded-lg font-body font-regular hover:opacity-90 transition-opacity w-full md:w-auto text-center md:text-left">Follow on LinkedIn &nbsp;→</a></div></div></div></section></div></div></div></main><footer role="contentinfo"><footer class="bg-avocado sm:px-4"><div class="max-w-6xl mx-auto flex flex-col md:flex-row sm:flex-col justify-between gap-2 items-center sm:items-center md:items-center py-10 font-nav text-lightGray text-base font-regular"><div class="pb-0 sm:pb-2 text-gray"><span class="pr-4">Copyright © 2026 Geshan Manandhar.</span></div><div class="pb-0 sm:pb-2"><ul class="flex"><li class="hover:text-gray-300 text-lg pr-4 cursor-pointer text-gray"><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer nofollow" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 1000 1000"><path fill="currentColor" d="M1000 267q0 112-78 188L747 631q-78 78-189 78q-97 0-171-63l115-115q26 17 56 17q44 0 75-31l175-176q31-29 31-74q0-44-30.5-74.5T734 162q-25 0-49.5 12T652 208H414L546 79Q626 1 734 1q110 0 188 78t78 188zm-387 89L498 471q-26-17-56-17q-44 0-75 31L192 661q-31 29-31 74q0 44 30.5 74.5T266 840q25 0 49.5-12t32.5-34h238L454 923q-80 78-188 78q-110 0-188-78T0 735q0-112 78-188l175-176q78-78 189-78q97 0 171 63z"/></svg> LinkedIn</a></li><li class="hover:text-gray-300 text-lg pr-4 cursor-pointer text-gray"><a href="https://www.twitter.com/geshan" target="_blank" rel="noopener noreferrer nofollow" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 1000 1000"><path fill="currentColor" d="M1000 267q0 112-78 188L747 631q-78 78-189 78q-97 0-171-63l115-115q26 17 56 17q44 0 75-31l175-176q31-29 31-74q0-44-30.5-74.5T734 162q-25 0-49.5 12T652 208H414L546 79Q626 1 734 1q110 0 188 78t78 188zm-387 89L498 471q-26-17-56-17q-44 0-75 31L192 661q-31 29-31 74q0 44 30.5 74.5T266 840q25 0 49.5-12t32.5-34h238L454 923q-80 78-188 78q-110 0-188-78T0 735q0-112 78-188l175-176q78-78 189-78q97 0 171 63z"/></svg> Twitter</a></li><li class="hover:text-gray-300 text-lg pr-4 cursor-pointer text-gray"><a href="https://github.com/geshan" target="_blank" rel="noopener noreferrer nofollow" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 1000 1000"><path fill="currentColor" d="M1000 267q0 112-78 188L747 631q-78 78-189 78q-97 0-171-63l115-115q26 17 56 17q44 0 75-31l175-176q31-29 31-74q0-44-30.5-74.5T734 162q-25 0-49.5 12T652 208H414L546 79Q626 1 734 1q110 0 188 78t78 188zm-387 89L498 471q-26-17-56-17q-44 0-75 31L192 661q-31 29-31 74q0 44 30.5 74.5T266 840q25 0 49.5-12t32.5-34h238L454 923q-80 78-188 78q-110 0-188-78T0 735q0-112 78-188l175-176q78-78 189-78q97 0 171 63z"/></svg> Github</a></li></ul></div></div></footer></footer><script src="/js/all.min.js" defer="defer"></script></body></html>