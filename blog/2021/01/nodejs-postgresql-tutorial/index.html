<!doctype html><html class="no-js" lang="en"><head><meta charset="utf-8"><meta name="author" content="Geshan Manandhar"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Follow this 2500+ word step-by-step tutorial to learn Node.js and PostgreSQL together. You will build a REST API for quotes using Express Js in this guide."><meta name="keywords" content="Nodejs postgres tutorial, Node.js postgres tutorial, nodejs postgres, nodejs express postgres, node.js express postgres example, nodejs postgres express tutorial, Node js postgresql tutorial, node js postgres tutorial"><meta name="p:domain_verify" content="e654c68562abebfa25c291f59d7d00e8"><meta property="og:type" content="website"><meta property="og:url" content="https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/"><meta property="og:title" content="Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step"><meta property="og:description" content="Follow this 2500+ word step-by-step tutorial to learn Node.js and PostgreSQL together. You will build a REST API for quotes using Express Js in this guide."><meta property="og:site_name" content="Geshan&#39;s Blog"><meta property="og:image" content="https://geshan.com.np/images/nodejs-postgresql-tutorial/01nodejs-postgres-tutorial.jpg"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:widgets:new-embed-design" content="on"><meta name="twitter:site" content="@geshan"><meta name="twitter:creator" content="@geshan"><meta name="twitter:title" content="Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step"><meta name="twitter:description" content="Follow this 2500+ word step-by-step tutorial to learn Node.js and PostgreSQL together. You will build a REST API for quotes using Express Js in this guide."><meta name="twitter:image:src" content="https://geshan.com.np/images/nodejs-postgresql-tutorial/01nodejs-postgres-tutorial.jpg"><link rel="canonical" href="https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/"><meta property="fb:pages" content="30717799226"><meta property="fb:app_id" content="106030259434380"><meta name="monetization" content="$ilp.uphold.com/aKHWpqhphm9f"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png"><link href="/atom.xml" rel="alternate" title="Geshan&#39;s Blog" type="application/atom+xml"><title>Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step</title><link rel="preconnect" href="/" crossorigin><link rel="preload" href="/css/fonts.css" as="style"><link rel="preload" href="/fonts/source-sans-4/source-serif-4-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/fonts/source-sans-4/source-serif-4-latin-500-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/fonts/source-sans-pro/source-sans-pro-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="/css/fonts.css"><link rel="stylesheet" href="/css/tw-006.css"><link rel="alternate" href="/atom.xml" type="application/atom+xml" title="Geshan&#39;s Blog"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-P3NXCVQEPE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-P3NXCVQEPE');</script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWT2D9T');</script><script src="https://cdn.jsdelivr.net/npm/@statsig/js-client@3/build/statsig-js-client+session-replay+web-analytics.min.js?apikey=client-rYO7rX8WSUyyLg9pKJwymLxM71tCE0CKgxgtUj4akzK"></script><link rel="manifest" href="/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="application-name" content="Geshan.com.np"><meta name="apple-mobile-web-app-title" content="Geshan.com.np"><meta name="msapplication-starturl" content="/index.html"><meta name="theme-color" content="#6947E7"><script>if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/sw.js").then(function(registration) {
        console.log('ServiceWorker registration successful with scope: ', registration.scope);
    }, function(err) {
        console.log('ServiceWorker registration failed: ', err);
    });
  }</script></head><body class="overflow-x-hidden font-ui flex flex-col min-h-screen"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWT2D9T" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><header role="banner"><div><nav class="bg-white" role="navigation"><div class="w-full md:max-w-6xl mx-auto py-4 px-4"><div class="flex items-center justify-between h-16"><div class="flex-shrink-0"><a href="/" class="flex items-center"><img class="h-12 w-12" src="/images/theme/new_logo.svg" alt="Geshan G"></a></div><div class="flex items-center gap-12"><div class="hidden sm:flex items-center gap-12"><a href="/posts/1/" class="uppercase text-base font-ui font-medium text-gray hover:text-midgrey transition-colors" aria-current="page">Posts </a><a href="/about/" class="uppercase text-base font-ui font-medium text-gray hover:text-midgrey transition-colors" aria-current="page">About Me </a><a href="https://newsletter.geshan.com.np/" class="uppercase text-base font-ui font-medium text-gray hover:text-midgrey transition-colors" aria-current="page">Newsletter</a></div><form class="search flex items-center" action="https://www.google.com/search" method="GET"><input type="hidden" name="sitesearch" value="geshan.com.np"><div class="relative"><input class="bg-gray-100 border border-neutralGray rounded-lg py-2 pl-10 pr-4 font-body text-sm focus:outline-none focus:ring-2 focus:ring-avocado focus:border-transparent w-40" type="text" name="q" placeholder="Search" label="search"> <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-neutralGray" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg></div></form><button type="button" class="sm:hidden inline-flex items-center justify-center p-2 rounded-md text-black focus:outline-none focus:ring-2 focus:ring-inset focus:ring-avocado" onclick="mobileView()" aria-controls="mobile-menu" aria-expanded="false"><span class="sr-only">Open main menu</span> <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button></div></div></div><div class="mobile-menu fixed inset-0 z-40 hidden sm:hidden bg-black bg-opacity-40" role="dialog" aria-modal="true"><div class="absolute inset-0" onclick="mobileView()" aria-hidden="true"></div><div class="mobile-menu-panel relative ml-auto flex h-full w-10/12 max-w-sm flex-col justify-start bg-white shadow-xl"><div class="flex items-center justify-between px-4 py-4 border-b border-gray-200"><div class="flex items-center gap-3"><img class="h-8 w-8" src="/images/theme/new_logo.svg" alt="Geshan G"> <span class="text-lg font-semibold text-textColor font-body">Geshan's Blog</span></div><button type="button" class="inline-flex items-center justify-center rounded-full p-2 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-avocado" onclick="mobileView()" aria-label="Close main menu"><svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button></div><nav class="overflow-y-auto px-4 py-6 space-y-2"><a href="/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">Home </a><a href="/posts/1/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">Posts </a><a href="/about/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">About Me </a><a href="https://newsletter.geshan.com.np/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">Newsletter</a></nav><div class="px 4 py-4 border-t border-gray-200"><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="rounded-lg bg-darkAvocado px-4 py-2 text-base font-regular font-body text-white hover:bg-avocado hover:text-black transition-colors w-2/3 mx-auto ml-4">Connect on LinkedIn</a></div></div></div></nav></div></header><main id="wrap" role="main" class="flex-grow md:px-0"><div id="content"><div class="row"><div><script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Geshan&#39;s Blog",
    "alternativeHeadline": "Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step",
    "image": "https://geshan.com.np/images/nodejs-postgresql-tutorial/01nodejs-postgres-tutorial.jpg",
    "editor": "Geshan Manandhar",
    "genre": "Web Development",
    "keywords": "Nodejs postgres tutorial, Node.js postgres tutorial, nodejs postgres, nodejs express postgres, node.js express postgres example, nodejs postgres express tutorial, Node js postgresql tutorial, node js postgres tutorial",
    "url": "https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/",
    "datePublished": "2021-01-01",
    "dateCreated": "2021-01-01",
    "dateModified": "2021-01-01",
    "description": "Follow this 2500+ word step-by-step tutorial to learn Node.js and PostgreSQL together. You will build a REST API for quotes using Express Js in this guide.",
    "articleBody": "Node.js can be used efficiently with relational databases like PostgreSQL. In this post about Node.js PostgreSQL tutorial, we are going to build a REST API for Quotes step-by-step using Express Js.Table of contents #PrerequisitesSteps for Node.js PostgreSQL tutorialSetup Express with express generatorDelete the public folderDelete unnecessary existing routes then create a new route for quotesChange index route to give out JSONSetup PostgreSQL with quote tableLink Node.js with PostgresShow Quotes - GET API with paginationSave a new quote - POST API for Node.js PostgreSQL tutorialAdding validation for creating quotes POST APITLDR; quick rundownConclusionYou can read my previous tutorial to try Node.js with MySQL. You should read this guide to use Docker with Node.js, it is also a step-by-step guide. You can, of course, carry on with this Node.js with PostgreSQL tutorial :).For your convinience, each step has been carved out as a distinct pull reqeust so that you can follow the tutorial with ease.Prerequisites #You have Node.js (preferably Node 18.x) installed and running on your machine (or Node.js running with a docker container).You are aware of how Node.js generally works and also have a bit of Express Js experience.Having some knowledge of Git and GitHub will be really useful.For the database we will use a free database on ElephantSQL, so please register and set up a free PostgreSQL database there. Of course, you should know how a relational database works. If you want to use PostgreSQL locally you should try out Docker and PostgreSQL.You are able to code using an IDE. I will be using VS Code as an editor but you are free to use any code editor of your choice for this Node.js PostgreSQL tutorial.Steps for Node.js PostgreSQL tutorial #We will be building a very simple REST API with Express Js that can send out some quotes. A quick refresher on what REST APIs are would be greatly helpful at this point.It will be great to read about HTTP verbs and brush up on some cURL commands too. We will be using cURL to run the examples.At this juncture, we believe that your Node.js is running fine. So let’s start with setting up Express js:Setup Express with express generator #To step Express js with express-generator run the following command:npx express-generator --no-view --git nodejs-postgresqlThe  some code  which after the change looks like:const express = require(&#39;express&#39;);const router = express.Router();const quotes = require(&#39;../services/quotes&#39;);/* GET quotes listing. */router.get(&#39;/&#39;, async function(req, res, next) {  try {    res.json(await quotes.getMultiple(req.query.page));  } catch (err) {    console.error(`Error while getting quotes `, err.message);    next(err);  }});module.exports = router;The main change here in the  some code  line as shown below:/* POST quotes */router.post(&#39;/&#39;, async function(req, res, next) {  try {    res.json(await quotes.create(req.body));  } catch (err) {    console.error(`Error while posting quotes `, err.message);    next(err);  }});module.exports = router;For the time being, we will not add any code level validation. The database table  some code  on your favorite browserYou should see the following on your browser:Conclusion #Setting up a REST API with Node.js and PostgreSQL was pretty fun till now. Still, it is more like scratching the surface. You can use the GitHub repo as a boilerplate to create simple REST APIs.This tutorial is a great starting point to build a full-on real-life REST API. I hope you can use this as commencement of something exciting. Best of luck!",
    "author": { "@type": "Person", "name": "Geshan Manandhar" },
    "publisher": {
      "@type": "Organization",
      "name": "Geshan Manandhar",
      "logo": { "@type": "ImageObject", "url": "https://geshan.com.np/images/favicons/favicon-32x32.png" }
    },
    "mainEntityOfPage": { "@type": "WebPage", "@id": "https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/" }
  }</script><div class="progress-bar"></div><div class="max-w-6xl py-3 mx-auto grid-cols-12 grid gap-15 px-4 md:px-0 mb-20"><div class="col-span-12"><article class="md:w-full mx-auto"><header class="page-header text-center"><h1 class="font-semibold font-heading text-gray text-center mb-6 tracking-[-0.01em] leading-[105%] md:leading-[105%]">Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step</h1><div class="flex items-center justify-between gap-3 md:gap-4 flex-wrap md:flex-nowrap py-2 border-y border-lightbg mt-4"><div class="flex items-center justify-start md:gap-4 gap-2 flex-wrap w-2/3"><div class="flex justify-start items-center gap-3 md:gap-4"><img src="/images/favicons/favicon-32x32-pp.png" alt="Geshan Manandhar" class="w-10 h-10 rounded-full object-cover flex-shrink-0"> <span class="text-gray font-medium font-ui text-md md:text-xl uppercase tracking-wide text-start">Geshan Manandhar</span></div><time datetime="2021-01-01" data-updated="true"><time class="entry-date" datetime="2021-01-01"><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">01-Jan-2021 </span></time></time><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">23 MIN READ</span></div><button type="button" id="share-button" class="flex items-center justify-center w-8 h-8 md:w-9 md:h-9 rounded text-lightGray hover:border-gray-400 hover:bg-gray-50 transition-colors flex-shrink-0" aria-label="Share this post" onclick="toggleShareIcons(); ga('send', 'event', 'share', 'clickShareOnPost');"><img src="/images/shareIcon.svg" alt="Share this post" class="w-6 h-6"></button></div><div id="share-icons-container" class="share-icons print:hidden hidden" aria-label="Share this post"><div class="flex items-center justify-center gap-3"><span class="share-icons"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/" target="_blank" title="Share 'Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step' on LinkedIn" onclick="ga('send', 'event', 'share', 'clickShareOnLinkedIn');"><span id="linkedin-share" class="text-[#0077B5]"><img src="/images/social-icons/linkedin.svg" alt="LinkedIn" class="sharing-common"> </span></a><a href="http://twitter.com/share?text=Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step - &url=https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/" target="_blank" title="Share 'Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step' on Twitter" onclick="ga('send', 'event', 'share', 'clickShareOnTwitter');"><span id="twitter-share" class="text-[#1DA1F2]"><img src="/images/social-icons/twitter.svg" alt="Twitter" class="sharing-common"> </span></a><a href="http://www.facebook.com/sharer.php?u=https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/" target="_blank" title="Share 'Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step' on Facebook" onclick="ga('send', 'event', 'share', 'clickShareOnFacebook');"><span id="facebook-share" class="text-[#1877F2]"><img src="/images/social-icons/facebook.svg" alt="Facebook" class="sharing-common"> </span></a><a href="https://t.me/share/url?url=https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/" target="_blank" title="Share 'Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step' on Telegram" onclick="ga('send', 'event', 'share', 'clickShareOnTelegram');"><span id="telegram-share" class="text-[#0088cc]"><img src="/images/social-icons/telegram.svg" alt="Telegram" class="sharing-common"> </span></a><a href="https://api.whatsapp.com/send?text=https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/" target="_blank" title="Share 'Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step' on Whatsapp" onclick="ga('send', 'event', 'share', 'clickShareOnWhatsapp');"><span id="whatsapp-share" class="text-[#25d366]"><img src="/images/social-icons/whatsapp.svg" alt="WhatsApp" class="sharing-common"></span></a></span></div></div></header><div class="entry-content clearfix font-body text-xl text-gray"><p>Node.js can be used efficiently with relational databases like PostgreSQL. In this post about Node.js PostgreSQL tutorial, we are going to build a REST API for Quotes step-by-step using Express Js.</p><img class="center" loading="lazy" src="/images/nodejs-postgresql-tutorial/01nodejs-postgres-tutorial.jpg" title="Node.js postgresql tutorial to build a quotes REST API using Express step-by-step" alt="Node.js postgresql tutorial to build a quotes REST API using Express step-by-step"><h2 id="table-of-contents" tabindex="-1">Table of contents <a class="direct-link" href="#table-of-contents">#</a></h2><nav class="toc"><ol><li><a href="#prerequisites">Prerequisites</a></li><li><a href="#steps-for-node.js-postgresql-tutorial">Steps for Node.js PostgreSQL tutorial</a><ol><li><a href="#setup-express-with-express-generator">Setup Express with express generator</a><ol><li><a href="#delete-the-public-folder">Delete the public folder</a></li><li><a href="#delete-unnecessary-existing-routes-then-create-a-new-route-for-quotes">Delete unnecessary existing routes then create a new route for quotes</a></li><li><a href="#change-index-route-to-give-out-json">Change index route to give out JSON</a></li></ol></li><li><a href="#setup-postgresql-with-quote-table">Setup PostgreSQL with quote table</a></li><li><a href="#link-node.js-with-postgres">Link Node.js with Postgres</a></li><li><a href="#show-quotes---get-api-with-pagination">Show Quotes - GET API with pagination</a></li><li><a href="#save-a-new-quote---post-api-for-node.js-postgresql-tutorial">Save a new quote - POST API for Node.js PostgreSQL tutorial</a><ol><li><a href="#adding-validation-for-creating-quotes-post-api">Adding validation for creating quotes POST API</a></li></ol></li></ol></li><li><a href="#tldr%3B-quick-rundown">TLDR; quick rundown</a></li><li><a href="#conclusion">Conclusion</a></li></ol></nav><p>You can read my previous tutorial to try <a href="/blog/2020/11/nodejs-mysql-tutorial/">Node.js with MySQL</a>. You should read this guide to use <a href="/blog/2020/11/nodejs-with-docker/">Docker with Node.js</a>, it is also a step-by-step guide. You can, of course, carry on with this Node.js with PostgreSQL tutorial :).</p><blockquote><p>For your convinience, each step has been carved out as a distinct pull reqeust so that you can follow the tutorial with ease.</p></blockquote><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="direct-link" href="#prerequisites">#</a></h2><ol><li>You have Node.js (preferably Node 18.x) installed and running on your machine (or Node.js running with a docker container).</li><li>You are aware of how Node.js generally works and also have a bit of Express Js experience.</li><li>Having some knowledge of Git and GitHub will be really useful.</li><li>For the database we will use a free database on <a href="https://www.elephantsql.com/">ElephantSQL</a>, so please register and set up a free PostgreSQL database there. Of course, you should know how a relational database works. If you want to use PostgreSQL locally you should try out <a href="/blog/2021/12/docker-postgres/">Docker and PostgreSQL</a>.</li><li>You are able to code using an IDE. I will be using VS Code as an editor but you are free to use any code editor of your choice for this Node.js PostgreSQL tutorial.</li></ol><h2 id="steps-for-node.js-postgresql-tutorial" tabindex="-1">Steps for Node.js PostgreSQL tutorial <a class="direct-link" href="#steps-for-node.js-postgresql-tutorial">#</a></h2><p>We will be building a very simple REST API with Express Js that can send out some quotes. A quick refresher on what <a href="https://www.mulesoft.com/resources/api/what-is-rest-api-design">REST APIs</a> are would be greatly helpful at this point.</p><blockquote><p>It will be great to read about HTTP verbs and brush up on some cURL commands too. We will be using cURL to run the examples.</p></blockquote><p>At this juncture, we believe that your Node.js is running fine. So let’s start with setting up Express js:</p><h3 id="setup-express-with-express-generator" tabindex="-1">Setup Express with express generator <a class="direct-link" href="#setup-express-with-express-generator">#</a></h3><p>To step Express js with <a href="https://expressjs.com/en/starter/generator.html">express-generator</a> run the following command:</p><pre class="language-bash"><code class="language-bash">npx express-generator --no-view <span class="token parameter variable">--git</span> nodejs-postgresql</code></pre><p>The <code>--no-view</code> parameter tells the generator to generate the Express app without any view like Pug. The other <code>--git</code> parameter indicates that we want to add the default <code>.gitignore</code> file in our Express app.<br>It will create the needed files in <code>nodesj-postgresql</code> directory. Your express will be set up when the command runs successfully. To quickly check if Express is setup correctly run the below:</p><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">cd</span> nodejs-posgresql <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> <span class="token function">install</span> <span class="token operator">&amp;&amp;</span> <span class="token assign-left variable">DEBUG</span><span class="token operator">=</span>nodejs-posgresql:* <span class="token function">npm</span> start</code></pre><p>You should see something similar on your browser when you hit <code>http://localhost:3000</code> on it:</p><img class="center" loading="lazy" src="/images/nodejs-postgresql-tutorial/02express.jpg" title="Express running on local at port 3000" alt="Express running on local at port 3000"><p>The generated barebones Express Js app can be viewed in this <a href="https://github.com/geshan/nodejs-posgresql/pull/1/files">pull request</a>.</p><h4 id="delete-the-public-folder" tabindex="-1">Delete the public folder <a class="direct-link" href="#delete-the-public-folder">#</a></h4><p>Because we are building a REST API for quotes for this Node.js PostgreSQL tutorial we don’t need any CSS or JS. Therefore, we will delete the generated <code>public</code> folder as we will deal with JSON.</p><p>To delete the generated public folder execute the following on your terminal:</p><pre class="language-bash"><code class="language-bash"><span class="token function">rm</span> <span class="token parameter variable">-rf</span> public</code></pre><h4 id="delete-unnecessary-existing-routes-then-create-a-new-route-for-quotes" tabindex="-1">Delete unnecessary existing routes then create a new route for quotes <a class="direct-link" href="#delete-unnecessary-existing-routes-then-create-a-new-route-for-quotes">#</a></h4><p>At this juncture, we will delete the unnecessary users' route found in <code>routes/users.js</code>. Consequently, we will add <code>routes/quotes.js</code> file that will have the following content:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">/* GET quotes listing. */</span><br>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>      <span class="token punctuation">{</span><br>        <span class="token literal-property property">quote</span><span class="token operator">:</span> <span class="token string">'First, solve the problem. Then, write the code.'</span><span class="token punctuation">,</span><br>        <span class="token literal-property property">author</span><span class="token operator">:</span> <span class="token string">'John Johnson'</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>      <span class="token literal-property property">page</span><span class="token operator">:</span> <span class="token number">1</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>For now, it will give a static output of only 1 quote as shown above. We will link up the quotes route in the <code>app.js</code> file like below:</p><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> cookieParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cookie-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'morgan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">var</span> indexRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./routes/index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> quotesRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./routes/quotes'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token string">'dev'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cookieParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> indexRouter<span class="token punctuation">)</span><span class="token punctuation">;</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/quotes'</span><span class="token punctuation">,</span> quotesRouter<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> app<span class="token punctuation">;</span></code></pre><p>The changes on the above file are only on lines 7 and 18 where the users’ router has been replaced with the quotes one.</p><h4 id="change-index-route-to-give-out-json" tabindex="-1">Change index route to give out JSON <a class="direct-link" href="#change-index-route-to-give-out-json">#</a></h4><p>The last change in this step is on line 6 of <code>index.js</code> file found in the root of the project. We will edit it to send out JSON in place of rendering a view. The file will look like before after this change:</p><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">/* GET home page. */</span><br>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'alive'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>You can check all the changes made in this step in this <a href="https://github.com/geshan/nodejs-posgresql/pull/2/files">pull request</a>.</p><p>To swiftly view the output of the above changes run the following:</p><pre class="language-bash"><code class="language-bash"><span class="token assign-left variable">DEBUG</span><span class="token operator">=</span>nodejs-postgresql:* <span class="token function">npm</span> start</code></pre><p>Then hit <code>http://localhost:3000/quotes</code> on the browser tab, you will see something like below:</p><img class="center" loading="lazy" src="/images/nodejs-postgresql-tutorial/03quotes-static.jpg" title="Quotes API with static output" alt="Quotes API with static output"><p>We will fetch the quotes from our PostgreSQL database in the next step.</p><h3 id="setup-postgresql-with-quote-table" tabindex="-1">Setup PostgreSQL with quote table <a class="direct-link" href="#setup-postgresql-with-quote-table">#</a></h3><p>We want to save you from the hassle of creating and maintaining a database locally on your machine. You can have a free PostgreSQL database on Elephant SQL with 20 MB data and 5 concurrent connections. It is more than enough for the purpose of this tutorial.</p><p>To create the PostgreSQL database on <a href="https://www.elephantsql.com/">Elephant SQL</a> after registering please follow this <a href="https://www.elephantsql.com/docs/">documentation</a>. Create the free (tiny turtle) database in the data center of your choice. If you want to learn more about PostgreSQL follow this multi-part <a href="https://www.elephantsql.com/blog/2017-02-24-databases-for-beginners-what-is-sql-what-is-postgresql.html">tutorial</a> on Elephant SQL.</p><p>After that, to create the quote table run the following SQL in the “browser” section of the created database:</p><pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> SEQUENCE quote_id_seq <span class="token keyword">START</span> <span class="token keyword">WITH</span> <span class="token number">1</span> INCREMENT <span class="token keyword">BY</span> <span class="token number">1</span> <span class="token keyword">NO</span> MINVALUE <span class="token keyword">NO</span> MAXVALUE CACHE <span class="token number">1</span><span class="token punctuation">;</span><br><br><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> quote <span class="token punctuation">(</span><br>    id <span class="token keyword">bigint</span> <span class="token keyword">DEFAULT</span> nextval<span class="token punctuation">(</span><span class="token string">'quote_id_seq'</span>::regclass<span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span><br>    quote <span class="token keyword">character</span> <span class="token keyword">varying</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span><br>    author <span class="token keyword">character</span> <span class="token keyword">varying</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><br>    created_at <span class="token keyword">timestamp</span> <span class="token keyword">with</span> <span class="token keyword">time</span> zone <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><br>    updated_at <span class="token keyword">timestamp</span> <span class="token keyword">with</span> <span class="token keyword">time</span> zone <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><br><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here is how it looks on the Elephant SQL interface:</p><img class="center" loading="lazy" src="/images/nodejs-postgresql-tutorial/04create-table-elephant-sql.jpg" title="Create Quotes table on Elephant SQL interface" alt="Create Quotes table on Elephant SQL interface"><p>This is a very simple table with 5 columns. The first one is the <code>id</code> which is a sequence and primary key. Then there are <code>quote</code> and <code>author</code> both are variable characters.</p><p>After that <code>created_at</code> and <code>updated_at</code> are both time stamps. There is a unique index added to the <code>quote</code> column so that we don’t have the same quote more than once. After the table is created we will fill up some quotes in the <code>quote</code> table executing the insert SQL below:</p><pre class="language-sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> quote <span class="token punctuation">(</span>quote<span class="token punctuation">,</span> author<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <br><span class="token punctuation">(</span><span class="token string">'There are only two kinds of languages: the ones people complain about and the ones nobody uses.'</span><span class="token punctuation">,</span> <span class="token string">'Bjarne Stroustrup'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'Any fool can write code that a computer can understand. Good programmers write code that humans can understand.'</span><span class="token punctuation">,</span> <span class="token string">'Martin Fowler'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'First, solve the problem. Then, write the code.'</span><span class="token punctuation">,</span> <span class="token string">'John Johnson'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'Java is to JavaScript what car is to Carpet.'</span><span class="token punctuation">,</span> <span class="token string">'Chris Heilmann'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'Always code as if the guy who ends up maintaining your code will be a violent psychopath who knows where you live.'</span><span class="token punctuation">,</span> <span class="token string">'John Woods'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'I''m not a great programmer; I''m just a good programmer with great habits.'</span><span class="token punctuation">,</span> <span class="token string">'Kent Beck'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'Truth can only be found in one place: the code.'</span><span class="token punctuation">,</span> <span class="token string">'Robert C. Martin'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'If you have to spend effort looking at a fragment of code and figuring out what it''s doing, then you should extract it into a function and name the function after the "what".'</span><span class="token punctuation">,</span> <span class="token string">'Martin Fowler'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'The real problem is that programmers have spent far too much time worrying about efficiency in the wrong places and at the wrong times; premature optimization is the root of all evil (or at least most of it) in programming.'</span><span class="token punctuation">,</span> <span class="token string">'Donald Knuth'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'SQL, Lisp, and Haskell are the only programming languages that I’ve seen where one spends more time thinking than typing.'</span><span class="token punctuation">,</span> <span class="token string">'Philip Greenspun'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'Deleted code is debugged code.'</span><span class="token punctuation">,</span> <span class="token string">'Jeff Sickel'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'There are two ways of constructing a software design: One way is to make it so simple that there are obviously no deficiencies and the other way is to make it so complicated that there are no obvious deficiencies.'</span><span class="token punctuation">,</span> <span class="token string">'C.A.R. Hoare'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'Simplicity is prerequisite for reliability.'</span><span class="token punctuation">,</span> <span class="token string">'Edsger W. Dijkstra'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'There are only two hard things in Computer Science: cache invalidation and naming things.'</span><span class="token punctuation">,</span> <span class="token string">'Phil Karlton'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'Measuring programming progress by lines of code is like measuring aircraft building progress by weight.'</span><span class="token punctuation">,</span> <span class="token string">'Bill Gates'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <br><span class="token punctuation">(</span><span class="token string">'Controlling complexity is the essence of computer programming.'</span><span class="token punctuation">,</span> <span class="token string">'Brian Kernighan'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br><span class="token punctuation">(</span><span class="token string">'The only way to learn a new programming language is by writing programs in it.'</span><span class="token punctuation">,</span> <span class="token string">'Dennis Ritchie'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>After you have inserted the 17 rows, if you run the following on the Elephant SQL browser interface:</p><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> quote<span class="token punctuation">;</span></code></pre><p>You should see something similar to below:</p><img class="center" loading="lazy" src="/images/nodejs-postgresql-tutorial/05select-elephant-sql.jpg" title="SELECT all from quote on Elephant SQL interface" alt="SELECT all from quote on Elephant SQL interface"><p>You can find the init database SQL file in this <a href="https://github.com/geshan/nodejs-posgresql/pull/3/files">pull request</a>. As our database is set up and ready let’s proceed to link it up with the Node.js Express application.</p><h3 id="link-node.js-with-postgres" tabindex="-1">Link Node.js with Postgres <a class="direct-link" href="#link-node.js-with-postgres">#</a></h3><p>To link up the Node.js Express Js application with the database that we have set up we will need to install the Postgres npm library. To get this useful library please run the following command:</p><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">--save</span> pg</code></pre><p>The changes we have got by installing this npm package are in this <a href="https://github.com/geshan/nodejs-posgresql/pull/4/files">pull request</a>. Time to proceed to add the GET quotes API route.</p><h3 id="show-quotes---get-api-with-pagination" tabindex="-1">Show Quotes - GET API with pagination <a class="direct-link" href="#show-quotes---get-api-with-pagination">#</a></h3><p>When you go to <code>http://localhost:3000/quotes</code> after starting the Express Js app, you can see something like below:</p><pre class="language-js"><code class="language-js"><span class="token punctuation">{</span><br>  <span class="token string-property property">"data"</span><span class="token operator">:</span><span class="token punctuation">[</span><br>    <span class="token punctuation">{</span><br>      <span class="token string-property property">"quote"</span><span class="token operator">:</span><span class="token string">"First, solve the problem. Then, write the code."</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"author"</span><span class="token operator">:</span><span class="token string">"John Johnson"</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">]</span><span class="token punctuation">,</span><br>  <span class="token string-property property">"meta"</span><span class="token operator">:</span><span class="token punctuation">{</span><br>    <span class="token string-property property">"page"</span><span class="token operator">:</span><span class="token number">1</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>Now we will replace this by fetching data from the PostgreSQL database on Elephant SQL. To do this, we will need to connect to the database.</p><p>Let’s create a <code>config.js</code> file on the root level. This config file has the database credentials and other configs like below:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> env <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">;</span><br><br><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token literal-property property">db</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">/* do not put password or any sensitive info here, done only for demo */</span><br>    <span class="token literal-property property">host</span><span class="token operator">:</span> env<span class="token punctuation">.</span><span class="token constant">DB_HOST</span> <span class="token operator">||</span> <span class="token string">'otto.db.elephantsql.com'</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">port</span><span class="token operator">:</span> env<span class="token punctuation">.</span><span class="token constant">DB_PORT</span> <span class="token operator">||</span> <span class="token string">'5432'</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">user</span><span class="token operator">:</span> env<span class="token punctuation">.</span><span class="token constant">DB_USER</span> <span class="token operator">||</span> <span class="token string">'cklijfef'</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">password</span><span class="token operator">:</span> env<span class="token punctuation">.</span><span class="token constant">DB_PASSWORD</span> <span class="token operator">||</span> <span class="token string">'V1qidES5k3DSJICDRgXtyT8qeu2SPCZp'</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">database</span><span class="token operator">:</span> env<span class="token punctuation">.</span><span class="token constant">DB_NAME</span> <span class="token operator">||</span> <span class="token string">'cklijfef'</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token literal-property property">listPerPage</span><span class="token operator">:</span> env<span class="token punctuation">.</span><span class="token constant">LIST_PER_PAGE</span> <span class="token operator">||</span> <span class="token number">10</span><span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> config<span class="token punctuation">;</span></code></pre><p>Subsequently, we will need to add a <code>services/db.js</code> file that will use a pool to run our SQL queries. It will look like below:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> Pool <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'pg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../config'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pool</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">/**<br> * Query the database using the pool<br> * @param {*} query <br> * @param {*} params <br> * <br> * @see https://node-postgres.com/features/pooling#single-query<br> */</span><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token parameter">query<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> <span class="token punctuation">{</span>rows<span class="token punctuation">,</span> fields<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> pool<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">return</span> rows<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><br>  query<br><span class="token punctuation">}</span></code></pre><p>After that we will add a <code>helper.js</code> file on the root level that will help us format the results and calculate the offset for pagination. It will have the following contents:</p><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getOffset</span><span class="token punctuation">(</span><span class="token parameter">currentPage <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> listPerPage</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span>currentPage <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">[</span>listPerPage<span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">function</span> <span class="token function">emptyOrRows</span><span class="token punctuation">(</span><span class="token parameter">rows</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>rows<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br>  <span class="token keyword">return</span> rows<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><br>  getOffset<span class="token punctuation">,</span><br>  emptyOrRows<br><span class="token punctuation">}</span></code></pre><p>At this juncture, we will add <code>services/quotes.js</code> file which will have contents as below:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./db'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> helper <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../helper'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../config'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getMultiple</span><span class="token punctuation">(</span><span class="token parameter">page <span class="token operator">=</span> <span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> offset <span class="token operator">=</span> helper<span class="token punctuation">.</span><span class="token function">getOffset</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> config<span class="token punctuation">.</span>listPerPage<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> rows <span class="token operator">=</span> <span class="token keyword">await</span> db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><br>    <span class="token string">'SELECT id, quote, author FROM quote OFFSET $1 LIMIT $2'</span><span class="token punctuation">,</span> <br>    <span class="token punctuation">[</span>offset<span class="token punctuation">,</span> config<span class="token punctuation">.</span>listPerPage<span class="token punctuation">]</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> data <span class="token operator">=</span> helper<span class="token punctuation">.</span><span class="token function">emptyOrRows</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> meta <span class="token operator">=</span> <span class="token punctuation">{</span>page<span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">{</span><br>    data<span class="token punctuation">,</span><br>    meta<br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><br>  getMultiple<br><span class="token punctuation">}</span></code></pre><p>All of this is glued from the routes file at <code>routes/quotes.js</code> which after the change looks like:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> quotes <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../services/quotes'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">/* GET quotes listing. */</span><br>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">try</span> <span class="token punctuation">{</span><br>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token keyword">await</span> quotes<span class="token punctuation">.</span><span class="token function">getMultiple</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>page<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Error while getting quotes </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">next</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>The main change here in the <code>routes/quotes.js</code> file is the addition of quotes service. After that, the <code>/quotes</code> is getting the quotes dynamically using the added quotes service.</p><p>Please take note that the quotes are already paginated, meaning <code>https://localhost:3000/quotes?page=2</code> will give out quotes 11-20 as it has 10 quotes per page in the config.js file. You can also represent the quotes as a <a href="/blog/2022/12/typescript-record/">TypeScript Record</a> Type which makes it easier to find by Id. The output at this point for page 2 should look something like below:</p><img class="center" loading="lazy" src="/images/nodejs-postgresql-tutorial/06quotes-api-page-2.jpg" title="Quotes on page 2 fetched dynamically from the database table" alt="Quotes on page 2 fetched dynamically from the database table"><p>Now let’s proceed to add the POST quote API which will insert a new quote on the database. As above, you can view all file changes for this step in this neatly organized <a href="https://github.com/geshan/nodejs-posgresql/pull/5/files">pull request</a>.</p><h3 id="save-a-new-quote---post-api-for-node.js-postgresql-tutorial" tabindex="-1">Save a new quote - POST API for Node.js PostgreSQL tutorial <a class="direct-link" href="#save-a-new-quote---post-api-for-node.js-postgresql-tutorial">#</a></h3><p>To create a new quote we will keep it a simple POST API. We will not use any validation library and keep the response codes as simple as possible.</p><p>The first thing we will do for adding the save new quote endpoint is to add it to the <code>/routes/quotes.js</code> file just above <code>module.exports = router</code> line as shown below:</p><pre class="language-js"><code class="language-js"><span class="token comment">/* POST quotes */</span><br>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">try</span> <span class="token punctuation">{</span><br>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token keyword">await</span> quotes<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Error while posting quotes </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">next</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>For the time being, we will not add any code level validation. The database table <code>quote</code> has the <code>quote</code> field required and 255 characters. So, if the quote is empty it will get a database level error. Unlike MySQL, PostgreSQL will give an error if the quote is longer than 255 characters.</p><p>In a more real-life scenario, I would recommend using a validation library for these kinds of cases. For now, let’s add the <code>create</code> method in <code>/services/quotes.js</code> like below:</p><pre class="language-js"><code class="language-js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">quote</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><br>    <span class="token string">'INSERT INTO quote(quote, author) VALUES ($1, $2) RETURNING *'</span><span class="token punctuation">,</span><br>    <span class="token punctuation">[</span>quote<span class="token punctuation">.</span>quote<span class="token punctuation">,</span> quote<span class="token punctuation">.</span>author<span class="token punctuation">]</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token string">'Error in creating quote'</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    message <span class="token operator">=</span> <span class="token string">'Quote created successfully'</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">{</span>message<span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><br>  getMultiple<span class="token punctuation">,</span><br>  create<br><span class="token punctuation">}</span></code></pre><p>After you run the server, you can try the following curl to see if it create a new quote:</p><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-i</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-H</span> <span class="token string">'Accept: application/json'</span> <span class="token punctuation">\</span><br>    <span class="token parameter variable">-H</span> <span class="token string">'Content-type: application/json'</span> http://localhost:3000/quotes <span class="token punctuation">\</span><br>    <span class="token parameter variable">--data</span> <span class="token string">'{"quote":"Before software can be reusable it first has to be usable2.","author":"Ralph Johnson"}'</span></code></pre><p>It should come back with a 200 response saying the quote has been created. You can try other quotes from this <a href="https://dzone.com/articles/best-programming-jokes-amp-quotes">post</a>.</p><p>With the create quote POST API working. You can easily build upon it to create the edit and the delete quote endpoints with respective <code>UPDATE</code> and <code>DELETE</code> SQL statements. Just be careful to pass the right id to carry out those operations.</p><p>Similar to the previous steps, all the code changes for this step can be found in this <a href="https://github.com/geshan/nodejs-posgresql/pull/6/files">pull request</a>.</p><h4 id="adding-validation-for-creating-quotes-post-api" tabindex="-1">Adding validation for creating quotes POST API <a class="direct-link" href="#adding-validation-for-creating-quotes-post-api">#</a></h4><p>Till now it should be functional but we should not push validation to the database layer as it will be more resource expensive. So in the next part of this step, we will add validation on the code level.</p><p>We will add a <code>validateCreate</code> method above <code>create</code> method in <code>/services/quotes.js</code> to do the validation like below:</p><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">validateCreate</span><span class="token punctuation">(</span><span class="token parameter">quote</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">let</span> messages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>quote<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>quote<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    messages<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'No object is provided'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>quote<span class="token punctuation">.</span>quote<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    messages<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'Quote is empty'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>quote<span class="token punctuation">.</span>author<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    messages<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'Quote is empty'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>quote<span class="token punctuation">.</span>quote <span class="token operator">&amp;&amp;</span> quote<span class="token punctuation">.</span>quote<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    messages<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'Quote cannot be longer than 255 characters'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>quote<span class="token punctuation">.</span>author <span class="token operator">&amp;&amp;</span> quote<span class="token punctuation">.</span>author<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    messages<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'Author name cannot be longer than 255 characters'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>messages<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">let</span> error <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>messages<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    error<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">throw</span> error<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">quote</span><span class="token punctuation">)</span><span class="token punctuation">{</span><br>  <span class="token function">validateCreate</span><span class="token punctuation">(</span>quote<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><br>    <span class="token string">'INSERT INTO quote(quote, author) VALUES ($1, $2) RETURNING *'</span><span class="token punctuation">,</span><br>    <span class="token punctuation">[</span>quote<span class="token punctuation">.</span>quote<span class="token punctuation">,</span> quote<span class="token punctuation">.</span>author<span class="token punctuation">]</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token string">'Error in creating quote'</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    message <span class="token operator">=</span> <span class="token string">'Quote created successfully'</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">{</span>message<span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>So now if you try the below cURL without an author, when the server is running it will show an error:</p><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-i</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-H</span> <span class="token string">'Accept: application/json'</span> <span class="token punctuation">\</span><br>    <span class="token parameter variable">-H</span> <span class="token string">'Content-type: application/json'</span> http://localhost:3000/quotes <span class="token punctuation">\</span><br>    <span class="token parameter variable">--data</span> <span class="token string">'{"quote":"Before software can be reusable it first has to be usable."}'</span> </code></pre><p>It will show something like below:</p><img class="center" loading="lazy" src="/images/nodejs-postgresql-tutorial/07validation-working.jpg" title="Creating a quote without author will give a validation error" alt="Creating a quote without author will give a validation error"><p>These changes are also reflected in a <a href="https://github.com/geshan/nodejs-posgresql/pull/7/files">pull request</a>.</p><blockquote><p>On dev, I would highly recommend using <a href="https://nodemon.io/">Nodemon</a> as it will restart the server on every file change.</p></blockquote><p>After you have <a href="/blog/2021/02/nodemon/">nodemon</a> installed globally you can run the app with the following command:</p><pre class="language-bash"><code class="language-bash"><span class="token assign-left variable">DEBUG</span><span class="token operator">=</span>nodejs-postgresql:* nodemon bin/www </code></pre><p>Nodemon is great for development. Some other <a href="/blog/2022/08/nodejs-alternatives/">Node.js alternatives</a> like Bun.js claim to be faster than Node, but Node.js is still the most popular option.</p><h2 id="tldr%3B-quick-rundown" tabindex="-1">TLDR; quick rundown <a class="direct-link" href="#tldr%3B-quick-rundown">#</a></h2><p>All the code shown above is in a public <a href="https://github.com/geshan/nodejs-posgresql">GitHub repository</a>, to quickly get started with what has already been built you can follow the steps below:</p><ol><li>Clone the repository with: <code>git clone git@github.com:geshan/nodejs-posgresql.git</code></li><li>Then run <code>cd nodejs-postgresql</code></li><li>Subsequently, execute: <code>npm install &amp;&amp; npm start</code></li><li>After that, hit: <code>https://localhost:3000/quotes</code> on your favorite browser</li><li>You should see the following on your browser:</li></ol><img class="center" loading="lazy" src="/images/nodejs-postgresql-tutorial/08quotes-page-1.jpg" title="Quotes on page 1" alt="Quotes on page 1"><h2 id="conclusion" tabindex="-1">Conclusion <a class="direct-link" href="#conclusion">#</a></h2><p>Setting up a REST API with Node.js and PostgreSQL was pretty fun till now. Still, it is more like scratching the surface. You can use the <a href="https://github.com/geshan/nodejs-posgresql">GitHub repo</a> as a boilerplate to create simple REST APIs.</p><blockquote><p>This tutorial is a great starting point to build a full-on real-life REST API. I hope you can use this as commencement of something exciting. Best of luck!</p></blockquote></div><div class="flex items-center justify-between gap-3 md:gap-4 flex-wrap md:flex-nowrap py-2 border-y border-lightbg mt-4"><div class="flex items-center justify-start md:gap-4 gap-2 flex-wrap w-2/3"><div class="flex justify-start items-center gap-3 md:gap-4"><img src="/images/favicons/favicon-32x32-pp.png" alt="Geshan Manandhar" class="w-10 h-10 rounded-full object-cover flex-shrink-0"> <span class="text-gray font-medium font-ui text-md md:text-xl uppercase tracking-wide text-start">Geshan Manandhar</span></div><time datetime="2021-01-01" data-updated="true"><time class="entry-date" datetime="2021-01-01"><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">01-Jan-2021 </span></time></time><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">23 MIN READ</span></div><button type="button" id="share-button-bottom" class="flex items-center justify-center w-8 h-8 md:w-9 md:h-9 rounded text-lightGray hover:border-gray-400 hover:bg-gray-50 transition-colors flex-shrink-0" aria-label="Share this post" onclick="toggleShareIconsBottom(); ga('send', 'event', 'share', 'clickShareOnPost');"><img src="/images/shareIcon.svg" alt="Share this post" class="w-6 h-6"></button></div><div id="share-icons-container-bottom" class="share-icons-bottom print:hidden hidden mx-auto" aria-label="Share this post"><div class="w-full flex items-center justify-center mx-auto gap-3"><span class="share-icons"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/" target="_blank" title="Share 'Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step' on LinkedIn" onclick="ga('send', 'event', 'share', 'clickShareOnLinkedIn');"><span id="linkedin-share" class="text-[#0077B5]"><img src="/images/social-icons/linkedin.svg" alt="LinkedIn" class="sharing-common"> </span></a><a href="http://twitter.com/share?text=Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step - &url=https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/" target="_blank" title="Share 'Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step' on Twitter" onclick="ga('send', 'event', 'share', 'clickShareOnTwitter');"><span id="twitter-share" class="text-[#1DA1F2]"><img src="/images/social-icons/twitter.svg" alt="Twitter" class="sharing-common"> </span></a><a href="http://www.facebook.com/sharer.php?u=https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/" target="_blank" title="Share 'Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step' on Facebook" onclick="ga('send', 'event', 'share', 'clickShareOnFacebook');"><span id="facebook-share" class="text-[#1877F2]"><img src="/images/social-icons/facebook.svg" alt="Facebook" class="sharing-common"> </span></a><a href="https://t.me/share/url?url=https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/" target="_blank" title="Share 'Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step' on Telegram" onclick="ga('send', 'event', 'share', 'clickShareOnTelegram');"><span id="telegram-share" class="text-[#0088cc]"><img src="/images/social-icons/telegram.svg" alt="Telegram" class="sharing-common"> </span></a><a href="https://api.whatsapp.com/send?text=https://geshan.com.np/blog/2021/01/nodejs-postgresql-tutorial/" target="_blank" title="Share 'Node.js Postgresql tutorial: Build a simple REST API with Express step-by-step' on Whatsapp" onclick="ga('send', 'event', 'share', 'clickShareOnWhatsapp');"><span id="whatsapp-share" class="text-[#25d366]"><img src="/images/social-icons/whatsapp.svg" alt="WhatsApp" class="sharing-common"></span></a></span></div></div></article><div class="mt-3"><a href="/blog/categories/web-development/" title="Web Development" class="background-lightbg mr-4 mb-2 inline-block mt-2 rounded border-2 bg-gray-100 font-semibold font-ui text-gray hover:text-gray-400 px-3 py-1 text-xl border-gray-300 cursor-pointer hover:border-gray-400">web development </a><a href="/blog/categories/node.js/" title="Node.js" class="background-lightbg mr-4 mb-2 inline-block mt-2 rounded border-2 bg-gray-100 font-semibold font-ui text-gray hover:text-gray-400 px-3 py-1 text-xl border-gray-300 cursor-pointer hover:border-gray-400">node.js </a><a href="/blog/categories/postgres/" title="Postgres" class="background-lightbg mr-4 mb-2 inline-block mt-2 rounded border-2 bg-gray-100 font-semibold font-ui text-gray hover:text-gray-400 px-3 py-1 text-xl border-gray-300 cursor-pointer hover:border-gray-400">postgres</a></div><section class="md:w-full mx-auto mt-4"><h3 class="comments font-heading">Comments</h3><div id="disqus_thread"></div><button id="disqus_trigger" class="font-ui text-blackText hover:border-darkAvocado border-blacktext hover:shadow-lg border-2 transition ease-in-out delay-100 px-3 py-2 pt-2 mt-2 rounded-md text-center block h-auto text-xl" onclick="load_disqus()">Post a Comment</button><div id="disqus_thread" aria-live="polite"></div></section></div></div><section class="md:w-full mx-auto mt-4 bg-lightAvocado p-4 rounded-lg pb-8"><div class="max-w-6xl mx-auto md:py-12 px-4"><h2 class="text-4xl text-darkAvocado font-heading font-regular flex-shrink-0 py-8 tracking-normal leading-[105%] md:leading-[105%]"><span class="text-lightGray italic">Related</span> <span class="text-blackText">Blogs</span></h2><div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2024/12/postgres-insert-on-conflict-update/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to Upsert Data in Postgres Using INSERT ON CONFLICT UPDATE</a> <time class="font-medium text-xl text-textColor uppercase font-ui">14-Dec-2024 &nbsp;&nbsp;&nbsp; 9 min read</time><p class="text-xl text-gray font-ui">Learn how to upsert data in Postgres using the INSERT ON CONFLICT UPDATE clause with practical examples. Combine insert and update operations into one UPSERT.</p></div><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2024/11/nodejs-dotenv/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to use environment variables from a .env file in Node.js</a> <time class="font-medium text-xl text-textColor uppercase font-ui">24-Nov-2024 &nbsp;&nbsp;&nbsp; 8 min read</time><p class="text-xl text-gray font-ui">Learn how to use environment variables with the dotenv NPM package and natively with Node 20+.</p></div><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2024/10/nodejs-read-json-file/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to Read a JSON File Using Node.js</a> <time class="font-medium text-xl text-textColor uppercase font-ui">30-Oct-2024 &nbsp;&nbsp;&nbsp; 10 min read</time><p class="text-xl text-gray font-ui">Learn how to read a JSON file using Node.js. This post covers reading a JSON file synchronously and asynchronously using the fs module and fs-extra NPM package.</p></div><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2023/12/nodejs-duet-ai-vs-code/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to write and deploy a basic Node.js API with Duet AI on VS Code a step-by-step guide</a> <time class="font-medium text-xl text-textColor uppercase font-ui">18-Dec-2023 &nbsp;&nbsp;&nbsp; 9 min read</time><p class="text-xl text-gray font-ui">Learn how to write and deploy a basic Node.js API with Duet AI on VS Code, in this step-by-step tutorial with 20+ screenshots!</p></div></div></div></section><section class="bg-avocado md:py-0 py-12 px-4"><div class="max-w-6xl mx-auto"><div class="md:hidden"><h2 class="mb-4 text-3xl font-heading font-regular text-textColor break-words tracking-[-0.01em] leading-[105%] md:leading-[105%]"><span class="text-textColor italic">Stay</span><span class="text-blackText"> Connected</span></h2><p class="text-base text-blackText font-body font-regular mb-6">Follow me on LinkedIn for new posts, engineering insights, and tech takes — straight from the trenches.</p><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="inline-block bg-darkAvocado text-base text-white px-6 py-3 rounded-lg font-body font-regular hover:opacity-90 transition-opacity w-full text-center">Follow on LinkedIn &nbsp;→</a></div><div class="hidden md:grid lg:hidden grid-cols-3 gap-8 items-center"><div class="z-10 col-span-2"><h2 class="mb-4 text-2xl md:text-4xl font-heading font-regular text-textColor break-words tracking-[-0.01em] leading-[105%] md:leading-[105%]"><span class="text-textColor italic">Stay</span><span class="text-blackText"> Connected</span></h2><p class="text-xl text-blackText font-body font-regular mb-6">Follow me on LinkedIn for new posts, engineering insights, and tech takes — straight from the trenches.</p><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="inline-block bg-darkAvocado text-xl text-white px-6 py-3 rounded-lg font-body font-regular hover:opacity-90 transition-opacity">Follow on LinkedIn &nbsp;→</a></div><div class="flex items-center justify-end col-span-1"><img class="w-32 h-auto" src="/images/theme/new_logo.svg" alt="Geshan"></div></div><div class="hidden lg:grid grid-cols-2 gap-8 lg:gap-12 items-center justify-between h-full"><div class="z-10"><h2 class="mb-4 text-2xl md:text-4xl font-heading font-regular text-textColor break-words tracking-[-0.01em] leading-[105%] md:leading-[105%]"><span class="text-textColor italic">Stay</span><span class="text-blackText"> Connected</span></h2><p class="text-xl text-blackText font-body font-regular mb-6">Follow me on LinkedIn for new posts, engineering insights, and tech takes — straight from the trenches.</p><p class="text-xl text-blackText font-body font-regular mb-6">A big thank you for supporting this ad. free, unobstructive (no overlays, no pop-ups) blog.</p></div><div class="flex items-center gap-12 w-full md:w-auto justify-end self-end"><img class="w-16 md:w-32 h-auto" src="/images/theme/new_logo.svg" alt="Geshan"> <a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="inline-block bg-darkAvocado text-xl text-white px-6 py-3 rounded-lg font-body font-regular hover:opacity-90 transition-opacity w-full md:w-auto text-center md:text-left">Follow on LinkedIn &nbsp;→</a></div></div></div></section></div></div></div></main><footer role="contentinfo"><footer class="bg-avocado sm:px-4"><div class="max-w-6xl mx-auto flex flex-col md:flex-row sm:flex-col justify-between gap-2 items-center sm:items-center md:items-center py-10 font-nav text-lightGray text-base font-regular"><div class="pb-0 sm:pb-2 text-gray"><span class="pr-4">Copyright © 2026 Geshan Manandhar.</span></div><div class="pb-0 sm:pb-2"><ul class="flex"><li class="hover:text-gray-300 text-lg pr-4 cursor-pointer text-gray"><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer nofollow" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 1000 1000"><path fill="currentColor" d="M1000 267q0 112-78 188L747 631q-78 78-189 78q-97 0-171-63l115-115q26 17 56 17q44 0 75-31l175-176q31-29 31-74q0-44-30.5-74.5T734 162q-25 0-49.5 12T652 208H414L546 79Q626 1 734 1q110 0 188 78t78 188zm-387 89L498 471q-26-17-56-17q-44 0-75 31L192 661q-31 29-31 74q0 44 30.5 74.5T266 840q25 0 49.5-12t32.5-34h238L454 923q-80 78-188 78q-110 0-188-78T0 735q0-112 78-188l175-176q78-78 189-78q97 0 171 63z"/></svg> LinkedIn</a></li><li class="hover:text-gray-300 text-lg pr-4 cursor-pointer text-gray"><a href="https://www.twitter.com/geshan" target="_blank" rel="noopener noreferrer nofollow" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 1000 1000"><path fill="currentColor" d="M1000 267q0 112-78 188L747 631q-78 78-189 78q-97 0-171-63l115-115q26 17 56 17q44 0 75-31l175-176q31-29 31-74q0-44-30.5-74.5T734 162q-25 0-49.5 12T652 208H414L546 79Q626 1 734 1q110 0 188 78t78 188zm-387 89L498 471q-26-17-56-17q-44 0-75 31L192 661q-31 29-31 74q0 44 30.5 74.5T266 840q25 0 49.5-12t32.5-34h238L454 923q-80 78-188 78q-110 0-188-78T0 735q0-112 78-188l175-176q78-78 189-78q97 0 171 63z"/></svg> Twitter</a></li><li class="hover:text-gray-300 text-lg pr-4 cursor-pointer text-gray"><a href="https://github.com/geshan" target="_blank" rel="noopener noreferrer nofollow" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 1000 1000"><path fill="currentColor" d="M1000 267q0 112-78 188L747 631q-78 78-189 78q-97 0-171-63l115-115q26 17 56 17q44 0 75-31l175-176q31-29 31-74q0-44-30.5-74.5T734 162q-25 0-49.5 12T652 208H414L546 79Q626 1 734 1q110 0 188 78t78 188zm-387 89L498 471q-26-17-56-17q-44 0-75 31L192 661q-31 29-31 74q0 44 30.5 74.5T266 840q25 0 49.5-12t32.5-34h238L454 923q-80 78-188 78q-110 0-188-78T0 735q0-112 78-188l175-176q78-78 189-78q97 0 171 63z"/></svg> Github</a></li></ul></div></div></footer></footer><script src="/js/all.min.js" defer="defer"></script></body></html>