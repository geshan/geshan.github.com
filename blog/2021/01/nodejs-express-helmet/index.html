<!doctype html><html class="no-js" lang="en"><head><meta charset="utf-8"><meta name="author" content="Geshan Manandhar"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Secure your Node.js Express application with Helmet js by adding some essential response headers, read more to know how easy it is in this 1400+ words guide."><meta name="keywords" content="express helmet, helmet js, nodejs express helmet, express helmet js, express js helmet"><meta name="p:domain_verify" content="e654c68562abebfa25c291f59d7d00e8"><meta property="og:type" content="website"><meta property="og:url" content="https://geshan.com.np/blog/2021/01/nodejs-express-helmet/"><meta property="og:title" content="Express Helmet: the must-have seatbelt for a secure Node.js application"><meta property="og:description" content="Secure your Node.js Express application with Helmet js by adding some essential response headers, read more to know how easy it is in this 1400+ words guide."><meta property="og:site_name" content="Geshan&#39;s Blog"><meta property="og:image" content="https://geshan.com.np/images/express-helmet/01express-helmet.jpg"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:widgets:new-embed-design" content="on"><meta name="twitter:site" content="@geshan"><meta name="twitter:creator" content="@geshan"><meta name="twitter:title" content="Express Helmet: the must-have seatbelt for a secure Node.js application"><meta name="twitter:description" content="Secure your Node.js Express application with Helmet js by adding some essential response headers, read more to know how easy it is in this 1400+ words guide."><meta name="twitter:image:src" content="https://geshan.com.np/images/express-helmet/01express-helmet.jpg"><link rel="canonical" href="https://geshan.com.np/blog/2021/01/nodejs-express-helmet/"><meta property="fb:pages" content="30717799226"><meta property="fb:app_id" content="106030259434380"><meta name="monetization" content="$ilp.uphold.com/aKHWpqhphm9f"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png"><link href="/atom.xml" rel="alternate" title="Geshan&#39;s Blog" type="application/atom+xml"><title>Express Helmet js: the must-have seatbelt for a secure Node.js application</title><link rel="preconnect" href="/" crossorigin><link rel="preload" href="/css/fonts.css" as="style"><link rel="preload" href="/fonts/source-sans-4/source-serif-4-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/fonts/source-sans-4/source-serif-4-latin-500-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="/fonts/source-sans-pro/source-sans-pro-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="/css/fonts.css"><link rel="stylesheet" href="/css/tw-006.css"><link rel="alternate" href="/atom.xml" type="application/atom+xml" title="Geshan&#39;s Blog"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-P3NXCVQEPE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-P3NXCVQEPE');</script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWT2D9T');</script><script src="https://cdn.jsdelivr.net/npm/@statsig/js-client@3/build/statsig-js-client+session-replay+web-analytics.min.js?apikey=client-rYO7rX8WSUyyLg9pKJwymLxM71tCE0CKgxgtUj4akzK"></script><link rel="manifest" href="/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="application-name" content="Geshan.com.np"><meta name="apple-mobile-web-app-title" content="Geshan.com.np"><meta name="msapplication-starturl" content="/index.html"><meta name="theme-color" content="#6947E7"><script>if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/sw.js").then(function(registration) {
        console.log('ServiceWorker registration successful with scope: ', registration.scope);
    }, function(err) {
        console.log('ServiceWorker registration failed: ', err);
    });
  }</script></head><body class="overflow-x-hidden font-ui flex flex-col min-h-screen"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWT2D9T" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><header role="banner"><div><nav class="bg-white" role="navigation"><div class="w-full md:max-w-6xl mx-auto py-4 px-4"><div class="flex items-center justify-between h-16"><div class="flex-shrink-0"><a href="/" class="flex items-center"><img class="h-12 w-12" src="/images/theme/new_logo.svg" alt="Geshan G"></a></div><div class="flex items-center gap-12"><div class="hidden sm:flex items-center gap-12"><a href="/posts/1/" class="uppercase text-base font-ui font-medium text-gray hover:text-midgrey transition-colors" aria-current="page">Posts </a><a href="/about/" class="uppercase text-base font-ui font-medium text-gray hover:text-midgrey transition-colors" aria-current="page">About Me </a><a href="https://newsletter.geshan.com.np/" class="uppercase text-base font-ui font-medium text-gray hover:text-midgrey transition-colors" aria-current="page">Newsletter</a></div><form class="search flex items-center" action="https://www.google.com/search" method="GET"><input type="hidden" name="sitesearch" value="geshan.com.np"><div class="relative"><input class="bg-gray-100 border border-neutralGray rounded-lg py-2 pl-10 pr-4 font-body text-sm focus:outline-none focus:ring-2 focus:ring-avocado focus:border-transparent w-40" type="text" name="q" placeholder="Search" label="search"> <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-neutralGray" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg></div></form><button type="button" class="sm:hidden inline-flex items-center justify-center p-2 rounded-md text-black focus:outline-none focus:ring-2 focus:ring-inset focus:ring-avocado" onclick="mobileView()" aria-controls="mobile-menu" aria-expanded="false"><span class="sr-only">Open main menu</span> <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button></div></div></div><div class="mobile-menu fixed inset-0 z-40 hidden sm:hidden bg-black bg-opacity-40" role="dialog" aria-modal="true"><div class="absolute inset-0" onclick="mobileView()" aria-hidden="true"></div><div class="mobile-menu-panel relative ml-auto flex h-full w-10/12 max-w-sm flex-col justify-start bg-white shadow-xl"><div class="flex items-center justify-between px-4 py-4 border-b border-gray-200"><div class="flex items-center gap-3"><img class="h-8 w-8" src="/images/theme/new_logo.svg" alt="Geshan G"> <span class="text-lg font-semibold text-textColor font-body">Geshan's Blog</span></div><button type="button" class="inline-flex items-center justify-center rounded-full p-2 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-avocado" onclick="mobileView()" aria-label="Close main menu"><svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button></div><nav class="overflow-y-auto px-4 py-6 space-y-2"><a href="/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">Home </a><a href="/posts/1/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">Posts </a><a href="/about/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">About Me </a><a href="https://newsletter.geshan.com.np/" class="block rounded-lg px-3 py-2 text-base font-medium font-ui text-black hover:bg-lightAvocado" aria-current="page">Newsletter</a></nav><div class="px 4 py-4 border-t border-gray-200"><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="rounded-lg bg-darkAvocado px-4 py-2 text-base font-regular font-body text-white hover:bg-avocado hover:text-black transition-colors w-2/3 mx-auto ml-4">Connect on LinkedIn</a></div></div></div></nav></div></header><main id="wrap" role="main" class="flex-grow md:px-0"><div id="content"><div class="row"><div><script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Geshan&#39;s Blog",
    "alternativeHeadline": "Express Helmet: the must-have seatbelt for a secure Node.js application",
    "image": "https://geshan.com.np/images/express-helmet/01express-helmet.jpg",
    "editor": "Geshan Manandhar",
    "genre": "Web Development",
    "keywords": "express helmet, helmet js, nodejs express helmet, express helmet js, express js helmet",
    "url": "https://geshan.com.np/blog/2021/01/nodejs-express-helmet/",
    "datePublished": "2021-01-08",
    "dateCreated": "2021-01-08",
    "dateModified": "2021-01-08",
    "description": "Secure your Node.js Express application with Helmet js by adding some essential response headers, read more to know how easy it is in this 1400+ words guide.",
    "articleBody": "Security is everyone’s responsibility. Express Helmet secures your Node.js application from some obvious threats. While writing a Node.js Express application, always use Helmet to safeguard your application or API from usual security risks like XSS, Content Security Policy, and others.In this post, we will see how we can add Helmet to an existing API and how it bolsters the security of the application. Let’s get started!Background Photo by Harley-Davidson on UnsplashTable of contents #Web application securityHandy OWASP cheat sheetsNode.js Web application securityExample Express Js applicationExpress without Helmet JsExpress Helmet to the rescueHelmet js with sane defaultsResponse headers for securityContent Security PolicyExpect Certificate TransparencyReferrer PolicyStrict Transport SecurityQuick scanBefore Express HelmetAfter Express HelmetConclusionWeb application security #Web application security is a pretty vast topic, people have written books about it. For example, OWASP comes up with a yearly top 10 web application security risks where Injection (like SQL injection) and Cross-Site Scripting (XSS) usually make it into the top 10 list.For example, with Node.js and MySQL you would want to use the MySQL2 library vs MySQL library because it supports prepared statements which can tackle SQL injection from the database level.There would be a lot of other security things you would want to learn about depending on how sensitive your public-facing application and its related data is.Handy OWASP cheat sheets #If you want to get your hands dirty with some Security stuff they have a long list of Cheat Sheets to get started quickly. It includes cheat sheets from docker security to SQL injection prevention. You want to find something on security, chances are you will find a cheat sheet from OWASP on that topic.Node.js Web application security #Focusing on a web application built with Node.js and Express. A library like Helmet can help on setting the right response headers which are great for a more secure application. As Node.js has a built-in web server it is easier for controlling the HTTP response headers from Node.js itself than another web server like Apache or Nginx.If you are using Koa you can use Koa Helmet to add important response headers.In case you are using other languages do consider the options available found in the see also section of the Helmet js website.For instance, there is a Secure Headers composer package for PHP, and for Django there exists a pip package called Django CSP.Example Express Js application #In this walkthrough, we will use the Currency API application which is open source. It is a simple currency converter proxy API that gives the exchange rate from one currency to the other for a given date.I have used it for other examples too like the faster docker builds one. I have also used the same application for docker multi-stage build post. It is a simple API, let’s analyze the headers and security risks it poses without Helmet.Express without Helmet Js #Below is the screenshot of the Header for the Currency API Node.js Express app without Helmet hosted on Vercel:One of the things that caught my attention is the  some code , etc, they are a bit less important than the 4 mentioned above.Quick scan #You can do a quick scan of your website’s security headers on SecurityHeaders.com. Below is the before and after results of the Currency API Express application:Before Express Helmet #As seen above, without the use of Express helmet it is missing important HTTP response headers like Content-Security-Policy, Referrer-Policy, and others. The score for the website at this point is a &amp;quot;D&amp;quot;.After Express Helmet #So from a poor &amp;quot;D&amp;quot; before Express Helmet, it jumped to a great &amp;quot;A&amp;quot; on Security Headers website.This means Helmet is a must for every Node.js Express application for better security response headers.If you are building an Express js application and thinking of putting it on production make adding Helmet js part of your go-to production checklist.Conclusion #Helmet is a great package for all Node.js Express applications.It should be used with proper configurations so that the application is secure and still optimally permissive too.There are other factors than just response headers and for better overall security we should focus also on other factors like secure cookies, the latest and secure versions of the packages, etc.",
    "author": { "@type": "Person", "name": "Geshan Manandhar" },
    "publisher": {
      "@type": "Organization",
      "name": "Geshan Manandhar",
      "logo": { "@type": "ImageObject", "url": "https://geshan.com.np/images/favicons/favicon-32x32.png" }
    },
    "mainEntityOfPage": { "@type": "WebPage", "@id": "https://geshan.com.np/blog/2021/01/nodejs-express-helmet/" }
  }</script><div class="progress-bar"></div><div class="max-w-6xl py-3 mx-auto grid-cols-12 grid gap-15 px-4 md:px-0 mb-20"><div class="col-span-12"><article class="md:w-full mx-auto"><header class="page-header text-center"><h1 class="font-semibold font-heading text-gray text-center mb-6 tracking-[-0.01em] leading-[105%] md:leading-[105%]">Express Helmet: the must-have seatbelt for a secure Node.js application</h1><div class="flex items-center justify-between gap-3 md:gap-4 flex-wrap md:flex-nowrap py-2 border-y border-lightbg mt-4"><div class="flex items-center justify-start md:gap-4 gap-2 flex-wrap w-2/3"><div class="flex justify-start items-center gap-3 md:gap-4"><img src="/images/favicons/favicon-32x32-pp.png" alt="Geshan Manandhar" class="w-10 h-10 rounded-full object-cover flex-shrink-0"> <span class="text-gray font-medium font-ui text-md md:text-xl uppercase tracking-wide text-start">Geshan Manandhar</span></div><time datetime="2021-01-08" data-updated="true"><time class="entry-date" datetime="2021-01-08"><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">08-Jan-2021 </span></time></time><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">8 MIN READ</span></div><button type="button" id="share-button" class="flex items-center justify-center w-8 h-8 md:w-9 md:h-9 rounded text-lightGray hover:border-gray-400 hover:bg-gray-50 transition-colors flex-shrink-0" aria-label="Share this post" onclick="toggleShareIcons(); ga('send', 'event', 'share', 'clickShareOnPost');"><img src="/images/shareIcon.svg" alt="Share this post" class="w-6 h-6"></button></div><div id="share-icons-container" class="share-icons print:hidden hidden" aria-label="Share this post"><div class="flex items-center justify-center gap-3"><span class="share-icons"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://geshan.com.np/blog/2021/01/nodejs-express-helmet/" target="_blank" title="Share 'Express Helmet: the must-have seatbelt for a secure Node.js application' on LinkedIn" onclick="ga('send', 'event', 'share', 'clickShareOnLinkedIn');"><span id="linkedin-share" class="text-[#0077B5]"><img src="/images/social-icons/linkedin.svg" alt="LinkedIn" class="sharing-common"> </span></a><a href="http://twitter.com/share?text=Express Helmet: the must-have seatbelt for a secure Node.js application - &url=https://geshan.com.np/blog/2021/01/nodejs-express-helmet/" target="_blank" title="Share 'Express Helmet: the must-have seatbelt for a secure Node.js application' on Twitter" onclick="ga('send', 'event', 'share', 'clickShareOnTwitter');"><span id="twitter-share" class="text-[#1DA1F2]"><img src="/images/social-icons/twitter.svg" alt="Twitter" class="sharing-common"> </span></a><a href="http://www.facebook.com/sharer.php?u=https://geshan.com.np/blog/2021/01/nodejs-express-helmet/" target="_blank" title="Share 'Express Helmet: the must-have seatbelt for a secure Node.js application' on Facebook" onclick="ga('send', 'event', 'share', 'clickShareOnFacebook');"><span id="facebook-share" class="text-[#1877F2]"><img src="/images/social-icons/facebook.svg" alt="Facebook" class="sharing-common"> </span></a><a href="https://t.me/share/url?url=https://geshan.com.np/blog/2021/01/nodejs-express-helmet/" target="_blank" title="Share 'Express Helmet: the must-have seatbelt for a secure Node.js application' on Telegram" onclick="ga('send', 'event', 'share', 'clickShareOnTelegram');"><span id="telegram-share" class="text-[#0088cc]"><img src="/images/social-icons/telegram.svg" alt="Telegram" class="sharing-common"> </span></a><a href="https://api.whatsapp.com/send?text=https://geshan.com.np/blog/2021/01/nodejs-express-helmet/" target="_blank" title="Share 'Express Helmet: the must-have seatbelt for a secure Node.js application' on Whatsapp" onclick="ga('send', 'event', 'share', 'clickShareOnWhatsapp');"><span id="whatsapp-share" class="text-[#25d366]"><img src="/images/social-icons/whatsapp.svg" alt="WhatsApp" class="sharing-common"></span></a></span></div></div></header><div class="entry-content clearfix font-body text-xl text-gray"><p>Security is everyone’s responsibility. Express Helmet secures your Node.js application from some obvious threats. While writing a Node.js <a href="https://expressjs.com/">Express</a> application, always use <a href="https://github.com/helmetjs/helmet">Helmet</a> to safeguard your application or API from usual security risks like XSS, Content Security Policy, and others.</p><p>In this post, we will see how we can add Helmet to an existing API and how it bolsters the security of the application. Let’s get started!</p><img class="center" loading="lazy" src="/images/express-helmet/01express-helmet.jpg" title="Use Helmet js to secure your Node.js Express app" alt="Use Helmet js to secure your Node.js Express app"><p>Background Photo by <a href="https://unsplash.com/@harleydavidson">Harley-Davidson</a> on <a href="https://unsplash.com/photos/ZZbniSDAGoU">Unsplash</a></p><h2 id="table-of-contents" tabindex="-1">Table of contents <a class="direct-link" href="#table-of-contents">#</a></h2><ul><li><a href="#web-application-security">Web application security</a><ul><li><a href="#handy-owasp-cheat-sheets">Handy OWASP cheat sheets</a></li><li><a href="#nodejs-web-application-security">Node.js Web application security</a></li></ul></li><li><a href="#example-express-js-application">Example Express Js application</a></li><li><a href="#express-without-helmet-js">Express without Helmet Js</a></li><li><a href="#express-helmet-to-the-rescue">Express Helmet to the rescue</a><ul><li><a href="#helmet-js-with-sane-defaults">Helmet js with sane defaults</a></li><li><a href="#response-headers-for-security">Response headers for security</a><ul><li><a href="#content-security-policy">Content Security Policy</a></li><li><a href="#expect-certificate-transparency">Expect Certificate Transparency</a></li><li><a href="#referrer-policy">Referrer Policy</a></li><li><a href="#strict-transport-security">Strict Transport Security</a></li></ul></li></ul></li><li><a href="#quick-scan">Quick scan</a><ul><li><a href="#before-express-helmet">Before Express Helmet</a></li><li><a href="#after-express-helmet">After Express Helmet</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li></ul><h2 id="web-application-security" tabindex="-1">Web application security <a class="direct-link" href="#web-application-security">#</a></h2><p>Web application security is a pretty vast topic, people have <a href="https://www.oreilly.com/library/view/web-application-security/9781492053101/">written</a> <a href="https://leanpub.com/wasec">books</a> about it. For example, OWASP comes up with a yearly <a href="https://owasp.org/www-project-top-ten/">top 10 web application security risks</a> where Injection (like SQL injection) and Cross-Site Scripting (XSS) usually make it into the top 10 list.</p><blockquote><p>For example, with <a href="/blog/2020/11/nodejs-mysql-tutorial/">Node.js and MySQL</a> you would want to use the <a href="https://github.com/sidorares/node-mysql2">MySQL2</a> library vs <a href="https://github.com/mysqljs/mysql">MySQL</a> library because it supports <a href="https://github.com/sidorares/node-mysql2#using-prepared-statements">prepared statements</a> which can tackle SQL injection from the database level.</p></blockquote><p>There would be a lot of other security things you would want to learn about depending on how sensitive your public-facing application and its related data is.</p><h3 id="handy-owasp-cheat-sheets" tabindex="-1">Handy OWASP cheat sheets <a class="direct-link" href="#handy-owasp-cheat-sheets">#</a></h3><p>If you want to get your hands dirty with some Security stuff they have a long list of <a href="https://cheatsheetseries.owasp.org/Glossary.html">Cheat Sheets</a> to get started quickly. It includes cheat sheets from <a href="https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html">docker security</a> to <a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">SQL injection prevention</a>. You want to find something on security, chances are you will find a cheat sheet from OWASP on that topic.</p><h3 id="node.js-web-application-security" tabindex="-1">Node.js Web application security <a class="direct-link" href="#node.js-web-application-security">#</a></h3><p>Focusing on a web application built with Node.js and Express. A library like Helmet can help on setting the right response headers which are great for a more secure application. As Node.js has a built-in web server it is easier for controlling the HTTP response headers from Node.js itself than another web server like Apache or Nginx.</p><p>If you are using Koa you can use <a href="https://github.com/venables/koa-helmet">Koa Helmet</a> to add important response headers.</p><blockquote><p>In case you are using other languages do consider the options available found in the <a href="https://helmetjs.github.io/see-also/">see also</a> section of the Helmet js website.</p></blockquote><p>For instance, there is a <a href="https://github.com/BePsvPT/secure-headers">Secure Headers</a> composer package for PHP, and for Django there exists a pip package called <a href="https://django-csp.readthedocs.io/en/latest/index.html">Django CSP</a>.</p><h2 id="example-express-js-application" tabindex="-1">Example Express Js application <a class="direct-link" href="#example-express-js-application">#</a></h2><p>In this walkthrough, we will use the Currency API application which is <a href="https://github.com/geshan/currency-api/">open source</a>. It is a simple currency converter proxy API that gives the exchange rate from one currency to the other for a given date.</p><p>I have used it for other examples too like the <a href="/blog/2020/10/docker-build-example-faster-docker-build/">faster docker builds</a> one. I have also used the same application for <a href="/blog/2019/11/how-to-use-docker-multi-stage-build/">docker multi-stage build</a> post. It is a simple API, let’s analyze the headers and security risks it poses without Helmet.</p><h2 id="express-without-helmet-js" tabindex="-1">Express without Helmet Js <a class="direct-link" href="#express-without-helmet-js">#</a></h2><p>Below is the screenshot of the Header for the Currency API Node.js Express app without Helmet hosted on Vercel:</p><img class="center" loading="lazy" src="/images/express-helmet/02express-without-helmet.jpg" title="Express without helmet does not have needed security HTTP Response Headers" alt="Express without helmet does not have needed security HTTP Response Headers"><p>One of the things that caught my attention is the <code>x-powered-by</code> response header. I don’t think it adds any value to the client by knowing it is an Express app. On the contrary, if an attacker finds out we are using an old version of Express, the attacker will try to exploit any known vulnerability. This header will be removed by Helmet.</p><p>Some more headers that would make the server secure that are missing are:</p><ul><li>Content-Security-Policy</li><li>Strict-Transport-Security</li><li>Expect-CT</li><li>Referrer-Policy</li><li>X-Content-Type-Options</li></ul><p>At this juncture, let’s add Helmet js to our Currency API Express application as the next step.</p><h2 id="express-helmet-to-the-rescue" tabindex="-1">Express Helmet to the rescue <a class="direct-link" href="#express-helmet-to-the-rescue">#</a></h2><p>We have seen that some Response headers are crucial for security. To get these essential Response headers that instruct the browser to make our website more secure we will add Helmet Js to our application. We can add Helmet to our Express API app by simply installing it with:</p><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> instal <span class="token parameter variable">--save</span> helmet</code></pre><p>After that, we will require helmet in our <code>index.js</code> file and use it as a middleware like below:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> helmet <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'helmet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> exchangeRates <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./src/exchangeRates'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">helmet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>You can view the changes as a <a href="https://github.com/geshan/currency-api/pull/113/files">pull request</a>.</p><h3 id="helmet-js-with-sane-defaults" tabindex="-1">Helmet js with sane defaults <a class="direct-link" href="#helmet-js-with-sane-defaults">#</a></h3><p>As seen in the above code change, we have just used helmet with <code>app.use(helmet());</code> without any extra configs added. The good thing about Express Helmet is that it automatically adds 11 sub middlewares with sane default configs.</p><blockquote><p>This may be one of the reasons that even the Express.js security best practices for production <a href="https://expressjs.com/en/advanced/best-practice-security.html#use-helmet">recommends</a> to use helmet js.</p></blockquote><p>In addition to using Helmet, it also mentions <a href="https://expressjs.com/en/advanced/best-practice-security.html#use-cookies-securely">securing cookies</a> and other things.</p><p>Looking further, it's time to see what new response headers has Helmet added with the default configuration:</p><img class="center" loading="lazy" src="/images/express-helmet/03express-with-helmet.jpg" title="Express with helmet has many needed security HTTP Response Headers" alt="Express with helmet has many needed security HTTP Response Headers"><p>I had done a similar request last time but this time the <code>x-powered-by</code> response header is missing, thanks to Express Helmet. On the contrary, Helmet has added some new hearers which are very useful from a security point of view. We will see further, what these headers are and analyze 4 of the main ones.</p><h3 id="response-headers-for-security" tabindex="-1">Response headers for security <a class="direct-link" href="#response-headers-for-security">#</a></h3><p>By adding Helmet with default configuration we can see that some new response headers have been added to our Currency API app’s response:</p><ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">Content-security-policy</a> is also known as CSP for short</li><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Expect-CT">Expect-CT</a> - CT is Certificate Transparency</li><li><a href="https://web.dev/referrer-best-practices/#referer-and-referrer-policy-101">Referrer-Policy</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">Strict-Transport-Security</a></li></ul><p>Let’s discuss these 4 in a bit more detail:</p><h4 id="content-security-policy" tabindex="-1">Content Security Policy <a class="direct-link" href="#content-security-policy">#</a></h4><p>This header adds a layer of security by declaring which dynamic resources are allowed to load. It helps to mitigate Cross Site Scripting (XSS) and some forms of Click jacking too. You can read more about <a href="https://content-security-policy.com/">CSP</a>.</p><p>For instance, with a strict CSP you can block images from other websites Following is the value of the Header given by Helmet as default:</p><pre class="language-html"><code class="language-html">content-security-policy: default-src 'self';base-uri 'self';block-all-mixed-content;font-src 'self' https: data:;frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests</code></pre><p>With the above policy, you can’t load a remote style as <code>style-src</code> is set to only <code>self</code>. Depending on your specific needs you can relax the policy. Have a look at the <a href="https://github.com/helmetjs/helmet#reference">config options</a> available on Express Helmet.</p><h4 id="expect-certificate-transparency" tabindex="-1">Expect Certificate Transparency <a class="direct-link" href="#expect-certificate-transparency">#</a></h4><p>Expect-CT as the name suggests checks for misuse of certificates. When a site enables the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Expect-CT">Expect-CT</a> header, they are requesting that the browser check that any certificate for that site appears in public CT logs.</p><p>Browsers ignore the Expect-CT header over HTTP; the header only has an effect on HTTPS connections. So this is an explicit check by the browser that the given certificate for the website is a valid one as per <a href="https://www.certificate-transparency.org/known-logs">public logs</a>. Helmet adds <code>expect-ct: max-age=0</code> meaning the browser should expect the certificate to be valid.</p><h4 id="referrer-policy" tabindex="-1">Referrer Policy <a class="direct-link" href="#referrer-policy">#</a></h4><p>In simple terms, referrer policy defines what data should be picked up from the referrer of the request. Helmet by default puts this to no data which means no part of the URL neither the origin nor the query string can be used on your website. Web.dev has a great piece on <a href="https://web.dev/referrer-best-practices">Referrer best practices</a> with easy to understand graphical explanations. Helmet adds <code>referrer-policy: no-referrer</code>, which is pretty restrictive.</p><h4 id="strict-transport-security" tabindex="-1">Strict Transport Security <a class="direct-link" href="#strict-transport-security">#</a></h4><p>This response header tells the browser that the website needs to be accessed using HTTPS not HTTP. It has <code>max-age</code> and <code>includeSubdomain</code> directives. Max-age tells the browser the time in seconds the browser should remember that the website should only be accessed using HTTPS. The <code>includeSubdomain</code> directive which is optional, tells this rule applies to the site’s subdomains as well. Helmet adds the following:</p><pre class="language-html"><code class="language-html">strict-transport-security: max-age=15552000; includeSubDomains</code></pre><p>So it says that the website needs to be accessed via HTTPS for 180 days with its subdomains.</p><p>There are other headers added by Helmet like <code>x-permitted-cross-domain-policies</code>, <code>X-Content-Type-Options</code>, etc, they are a bit less important than the 4 mentioned above.</p><h2 id="quick-scan" tabindex="-1">Quick scan <a class="direct-link" href="#quick-scan">#</a></h2><p>You can do a quick scan of your website’s security headers on <a href="https://securityheaders.com/">SecurityHeaders.com</a>. Below is the before and after results of the Currency API Express application:</p><h3 id="before-express-helmet" tabindex="-1">Before Express Helmet <a class="direct-link" href="#before-express-helmet">#</a></h3><img class="center" loading="lazy" src="/images/express-helmet/04express-before-helmet.jpg" title="Express before adding helmet got a D on SecurityHeader.com" alt="Express before adding helmet got a D on SecurityHeader.com"><p>As seen above, without the use of Express helmet it is missing important HTTP response headers like Content-Security-Policy, Referrer-Policy, and others. The score for the website at this point is a &quot;D&quot;.</p><h3 id="after-express-helmet" tabindex="-1">After Express Helmet <a class="direct-link" href="#after-express-helmet">#</a></h3><img class="center" loading="lazy" src="/images/express-helmet/05express-after-helmet.jpg" title="Express after adding helmet got an amazing A on SecurityHeader.com" alt="Express after adding helmet got an amazing A SecurityHeader.com"><p>So from a poor &quot;D&quot; before Express Helmet, it jumped to a great &quot;A&quot; on Security Headers website.</p><blockquote><p>This means Helmet is a must for every Node.js Express application for better security response headers.</p></blockquote><p>If you are building an Express js application and thinking of putting it on production make adding Helmet js part of your go-to production checklist.</p><h2 id="conclusion" tabindex="-1">Conclusion <a class="direct-link" href="#conclusion">#</a></h2><p>Helmet is a great package for all Node.js Express applications.</p><blockquote><p>It should be used with proper configurations so that the application is secure and still optimally permissive too.</p></blockquote><p>There are other factors than just response headers and for better overall security we should focus also on other factors like secure cookies, the latest and secure versions of the packages, etc.</p></div><div class="flex items-center justify-between gap-3 md:gap-4 flex-wrap md:flex-nowrap py-2 border-y border-lightbg mt-4"><div class="flex items-center justify-start md:gap-4 gap-2 flex-wrap w-2/3"><div class="flex justify-start items-center gap-3 md:gap-4"><img src="/images/favicons/favicon-32x32-pp.png" alt="Geshan Manandhar" class="w-10 h-10 rounded-full object-cover flex-shrink-0"> <span class="text-gray font-medium font-ui text-md md:text-xl uppercase tracking-wide text-start">Geshan Manandhar</span></div><time datetime="2021-01-08" data-updated="true"><time class="entry-date" datetime="2021-01-08"><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">08-Jan-2021 </span></time></time><span class="text-textColor font-ui font-medium text-md md:text-xl uppercase">8 MIN READ</span></div><button type="button" id="share-button-bottom" class="flex items-center justify-center w-8 h-8 md:w-9 md:h-9 rounded text-lightGray hover:border-gray-400 hover:bg-gray-50 transition-colors flex-shrink-0" aria-label="Share this post" onclick="toggleShareIconsBottom(); ga('send', 'event', 'share', 'clickShareOnPost');"><img src="/images/shareIcon.svg" alt="Share this post" class="w-6 h-6"></button></div><div id="share-icons-container-bottom" class="share-icons-bottom print:hidden hidden mx-auto" aria-label="Share this post"><div class="w-full flex items-center justify-center mx-auto gap-3"><span class="share-icons"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://geshan.com.np/blog/2021/01/nodejs-express-helmet/" target="_blank" title="Share 'Express Helmet: the must-have seatbelt for a secure Node.js application' on LinkedIn" onclick="ga('send', 'event', 'share', 'clickShareOnLinkedIn');"><span id="linkedin-share" class="text-[#0077B5]"><img src="/images/social-icons/linkedin.svg" alt="LinkedIn" class="sharing-common"> </span></a><a href="http://twitter.com/share?text=Express Helmet: the must-have seatbelt for a secure Node.js application - &url=https://geshan.com.np/blog/2021/01/nodejs-express-helmet/" target="_blank" title="Share 'Express Helmet: the must-have seatbelt for a secure Node.js application' on Twitter" onclick="ga('send', 'event', 'share', 'clickShareOnTwitter');"><span id="twitter-share" class="text-[#1DA1F2]"><img src="/images/social-icons/twitter.svg" alt="Twitter" class="sharing-common"> </span></a><a href="http://www.facebook.com/sharer.php?u=https://geshan.com.np/blog/2021/01/nodejs-express-helmet/" target="_blank" title="Share 'Express Helmet: the must-have seatbelt for a secure Node.js application' on Facebook" onclick="ga('send', 'event', 'share', 'clickShareOnFacebook');"><span id="facebook-share" class="text-[#1877F2]"><img src="/images/social-icons/facebook.svg" alt="Facebook" class="sharing-common"> </span></a><a href="https://t.me/share/url?url=https://geshan.com.np/blog/2021/01/nodejs-express-helmet/" target="_blank" title="Share 'Express Helmet: the must-have seatbelt for a secure Node.js application' on Telegram" onclick="ga('send', 'event', 'share', 'clickShareOnTelegram');"><span id="telegram-share" class="text-[#0088cc]"><img src="/images/social-icons/telegram.svg" alt="Telegram" class="sharing-common"> </span></a><a href="https://api.whatsapp.com/send?text=https://geshan.com.np/blog/2021/01/nodejs-express-helmet/" target="_blank" title="Share 'Express Helmet: the must-have seatbelt for a secure Node.js application' on Whatsapp" onclick="ga('send', 'event', 'share', 'clickShareOnWhatsapp');"><span id="whatsapp-share" class="text-[#25d366]"><img src="/images/social-icons/whatsapp.svg" alt="WhatsApp" class="sharing-common"></span></a></span></div></div></article><div class="mt-3"><a href="/blog/categories/web-development/" title="Web Development" class="background-lightbg mr-4 mb-2 inline-block mt-2 rounded border-2 bg-gray-100 font-semibold font-ui text-gray hover:text-gray-400 px-3 py-1 text-xl border-gray-300 cursor-pointer hover:border-gray-400">web development </a><a href="/blog/categories/node.js/" title="Node.js" class="background-lightbg mr-4 mb-2 inline-block mt-2 rounded border-2 bg-gray-100 font-semibold font-ui text-gray hover:text-gray-400 px-3 py-1 text-xl border-gray-300 cursor-pointer hover:border-gray-400">node.js</a></div><section class="md:w-full mx-auto mt-4"><h3 class="comments font-heading">Comments</h3><div id="disqus_thread"></div><button id="disqus_trigger" class="font-ui text-blackText hover:border-darkAvocado border-blacktext hover:shadow-lg border-2 transition ease-in-out delay-100 px-3 py-2 pt-2 mt-2 rounded-md text-center block h-auto text-xl" onclick="load_disqus()">Post a Comment</button><div id="disqus_thread" aria-live="polite"></div></section></div></div><section class="md:w-full mx-auto mt-4 bg-lightAvocado p-4 rounded-lg pb-8"><div class="max-w-6xl mx-auto md:py-12 px-4"><h2 class="text-4xl text-darkAvocado font-heading font-regular flex-shrink-0 py-8 tracking-normal leading-[105%] md:leading-[105%]"><span class="text-lightGray italic">Related</span> <span class="text-blackText">Blogs</span></h2><div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2024/11/nodejs-dotenv/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to use environment variables from a .env file in Node.js</a> <time class="font-medium text-xl text-textColor uppercase font-ui">24-Nov-2024 &nbsp;&nbsp;&nbsp; 8 min read</time><p class="text-xl text-gray font-ui">Learn how to use environment variables with the dotenv NPM package and natively with Node 20+.</p></div><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2024/10/nodejs-read-json-file/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to Read a JSON File Using Node.js</a> <time class="font-medium text-xl text-textColor uppercase font-ui">30-Oct-2024 &nbsp;&nbsp;&nbsp; 10 min read</time><p class="text-xl text-gray font-ui">Learn how to read a JSON file using Node.js. This post covers reading a JSON file synchronously and asynchronously using the fs module and fs-extra NPM package.</p></div><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2023/12/nodejs-duet-ai-vs-code/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to write and deploy a basic Node.js API with Duet AI on VS Code a step-by-step guide</a> <time class="font-medium text-xl text-textColor uppercase font-ui">18-Dec-2023 &nbsp;&nbsp;&nbsp; 9 min read</time><p class="text-xl text-gray font-ui">Learn how to write and deploy a basic Node.js API with Duet AI on VS Code, in this step-by-step tutorial with 20+ screenshots!</p></div><div class="py-4 border-b border-avocado pb-4 flex flex-col gap-2 font-ui"><a href="/blog/2023/03/mongodb-docker-compose/" class="font-semibold font-ui text-gray text-xl md:text-2xl tracking-[-0.01em] leading-[105%] md:leading-[105%]">How to run MongoDB with Docker and Docker Compose a Step-by-Step guide</a> <time class="font-medium text-xl text-textColor uppercase font-ui">29-Mar-2023 &nbsp;&nbsp;&nbsp; 9 min read</time><p class="text-xl text-gray font-ui">In this step-by-step tutorial learn how to run MongoDB with Docker and Docker Compose. Also has an example with Node.js + MongoDB with Docker Compose.</p></div></div></div></section><section class="bg-avocado md:py-0 py-12 px-4"><div class="max-w-6xl mx-auto"><div class="md:hidden"><h2 class="mb-4 text-3xl font-heading font-regular text-textColor break-words tracking-[-0.01em] leading-[105%] md:leading-[105%]"><span class="text-textColor italic">Stay</span><span class="text-blackText"> Connected</span></h2><p class="text-base text-blackText font-body font-regular mb-6">Follow me on LinkedIn for new posts, engineering insights, and tech takes — straight from the trenches.</p><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="inline-block bg-darkAvocado text-base text-white px-6 py-3 rounded-lg font-body font-regular hover:opacity-90 transition-opacity w-full text-center">Follow on LinkedIn &nbsp;→</a></div><div class="hidden md:grid lg:hidden grid-cols-3 gap-8 items-center"><div class="z-10 col-span-2"><h2 class="mb-4 text-2xl md:text-4xl font-heading font-regular text-textColor break-words tracking-[-0.01em] leading-[105%] md:leading-[105%]"><span class="text-textColor italic">Stay</span><span class="text-blackText"> Connected</span></h2><p class="text-xl text-blackText font-body font-regular mb-6">Follow me on LinkedIn for new posts, engineering insights, and tech takes — straight from the trenches.</p><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="inline-block bg-darkAvocado text-xl text-white px-6 py-3 rounded-lg font-body font-regular hover:opacity-90 transition-opacity">Follow on LinkedIn &nbsp;→</a></div><div class="flex items-center justify-end col-span-1"><img class="w-32 h-auto" src="/images/theme/new_logo.svg" alt="Geshan"></div></div><div class="hidden lg:grid grid-cols-2 gap-8 lg:gap-12 items-center justify-between h-full"><div class="z-10"><h2 class="mb-4 text-2xl md:text-4xl font-heading font-regular text-textColor break-words tracking-[-0.01em] leading-[105%] md:leading-[105%]"><span class="text-textColor italic">Stay</span><span class="text-blackText"> Connected</span></h2><p class="text-xl text-blackText font-body font-regular mb-6">Follow me on LinkedIn for new posts, engineering insights, and tech takes — straight from the trenches.</p><p class="text-xl text-blackText font-body font-regular mb-6">A big thank you for supporting this ad. free, unobstructive (no overlays, no pop-ups) blog.</p></div><div class="flex items-center gap-12 w-full md:w-auto justify-end self-end"><img class="w-16 md:w-32 h-auto" src="/images/theme/new_logo.svg" alt="Geshan"> <a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer" class="inline-block bg-darkAvocado text-xl text-white px-6 py-3 rounded-lg font-body font-regular hover:opacity-90 transition-opacity w-full md:w-auto text-center md:text-left">Follow on LinkedIn &nbsp;→</a></div></div></div></section></div></div></div></main><footer role="contentinfo"><footer class="bg-avocado sm:px-4"><div class="max-w-6xl mx-auto flex flex-col md:flex-row sm:flex-col justify-between gap-2 items-center sm:items-center md:items-center py-10 font-nav text-lightGray text-base font-regular"><div class="pb-0 sm:pb-2 text-gray"><span class="pr-4">Copyright © 2026 Geshan Manandhar.</span></div><div class="pb-0 sm:pb-2"><ul class="flex"><li class="hover:text-gray-300 text-lg pr-4 cursor-pointer text-gray"><a href="https://www.linkedin.com/in/geshan" target="_blank" rel="noopener noreferrer nofollow" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 1000 1000"><path fill="currentColor" d="M1000 267q0 112-78 188L747 631q-78 78-189 78q-97 0-171-63l115-115q26 17 56 17q44 0 75-31l175-176q31-29 31-74q0-44-30.5-74.5T734 162q-25 0-49.5 12T652 208H414L546 79Q626 1 734 1q110 0 188 78t78 188zm-387 89L498 471q-26-17-56-17q-44 0-75 31L192 661q-31 29-31 74q0 44 30.5 74.5T266 840q25 0 49.5-12t32.5-34h238L454 923q-80 78-188 78q-110 0-188-78T0 735q0-112 78-188l175-176q78-78 189-78q97 0 171 63z"/></svg> LinkedIn</a></li><li class="hover:text-gray-300 text-lg pr-4 cursor-pointer text-gray"><a href="https://www.twitter.com/geshan" target="_blank" rel="noopener noreferrer nofollow" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 1000 1000"><path fill="currentColor" d="M1000 267q0 112-78 188L747 631q-78 78-189 78q-97 0-171-63l115-115q26 17 56 17q44 0 75-31l175-176q31-29 31-74q0-44-30.5-74.5T734 162q-25 0-49.5 12T652 208H414L546 79Q626 1 734 1q110 0 188 78t78 188zm-387 89L498 471q-26-17-56-17q-44 0-75 31L192 661q-31 29-31 74q0 44 30.5 74.5T266 840q25 0 49.5-12t32.5-34h238L454 923q-80 78-188 78q-110 0-188-78T0 735q0-112 78-188l175-176q78-78 189-78q97 0 171 63z"/></svg> Twitter</a></li><li class="hover:text-gray-300 text-lg pr-4 cursor-pointer text-gray"><a href="https://github.com/geshan" target="_blank" rel="noopener noreferrer nofollow" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 1000 1000"><path fill="currentColor" d="M1000 267q0 112-78 188L747 631q-78 78-189 78q-97 0-171-63l115-115q26 17 56 17q44 0 75-31l175-176q31-29 31-74q0-44-30.5-74.5T734 162q-25 0-49.5 12T652 208H414L546 79Q626 1 734 1q110 0 188 78t78 188zm-387 89L498 471q-26-17-56-17q-44 0-75 31L192 661q-31 29-31 74q0 44 30.5 74.5T266 840q25 0 49.5-12t32.5-34h238L454 923q-80 78-188 78q-110 0-188-78T0 735q0-112 78-188l175-176q78-78 189-78q97 0 171 63z"/></svg> Github</a></li></ul></div></div></footer></footer><script src="/js/all.min.js" defer="defer"></script></body></html>